(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"1bzv":function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(){}},"1uvf":function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("CcnG"),o=i("gIcY"),r=(i("8tIk"),i("o3mN"),i("HXRl"),i("6l49"),function(e){return e[e.file=0]="file",e[e.url=1]="url",e}({})),s=function(){function e(e,t,i,o,s){this.folderManagementService=e,this.fileUploadService=t,this.formBuilder=i,this.notificationService=o,this.sessionService=s,this.isLoading=!1,this.close$=new n.n,this.attachmentType=r,this.selectedAttachmentType=this.attachmentType.file}return Object.defineProperty(e.prototype,"fileName",{get:function(){return this.documentProfile?this.documentProfile.FileName:""},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.generateForm()},e.prototype.ngAfterContentChecked=function(){this.document&&!this.previousData&&(this.previousData=this.document,this.topicId=this.document.TopicId,this.siteId=this.document.SiteId,this.getDocumentProfile())},e.prototype.generateForm=function(){this.replaceAttachmentForm=this.formBuilder.group({fileName:[{value:"",disabled:!0}],attachmentFileName:[{value:"",disabled:!0}],attachmentFileToken:["",[o.x.required]],url:[""],reason:["",[o.x.required]]})},e.prototype.getDocumentProfile=function(){var e=this,t={siteId:this.siteId,topicId:this.topicId,tmfPublishing:{RetrieveFromTmf:null}};this.isLoading=!0,this.folderManagementService.getDocumentProfile(t).subscribe(function(t){0===t.ErrorCode?(e.documentProfile=t.Result,e.replaceAttachmentForm.get("fileName").setValue(t.Result.FileName)):e.notificationService.showError(t.ErrorCode),e.isLoading=!1})},e.prototype.handleFiles=function(e){var t=this,i=e.target.files[0];this.replaceAttachmentForm.get("attachmentFileName").setValue(i.name);var n=new FormData;n.append("file",i),this.fileUploadService.uploadFile(n,this.sessionService.currentRoomId).subscribe(function(e){null!==e.Result?t.replaceAttachmentForm.get("attachmentFileToken").setValue(e.Result.FileToken):t.replaceAttachmentForm.get("attachmentFileToken").setValue("null")})},e.prototype.setAttachmentType=function(e){this.selectedAttachmentType=e;var t=this.replaceAttachmentForm.get("attachmentFileName"),i=this.replaceAttachmentForm.get("attachmentFileToken"),n=this.replaceAttachmentForm.get("url");this.selectedAttachmentType===this.attachmentType.file?(this.clearFields(n),i.setValidators([o.x.required])):this.selectedAttachmentType===this.attachmentType.url&&(this.clearFields(t,i),n.setValidators([o.x.required,this.isValidUrl()])),n.updateValueAndValidity(),i.updateValueAndValidity()},e.prototype.clearFields=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach(function(e){e.setValue(""),e.markAsPristine(),e.markAsUntouched(),e.clearValidators()})},e.prototype.browseFiles=function(){this.browseInput.nativeElement.click()},e.prototype.onClose=function(){this.close$.emit()},e.prototype.apply=function(){var e=this,t={siteId:this.siteId,document:{ReplaceAttachmentReason:this.replaceAttachmentForm.get("reason").value,ReplaceAttachmentOnly:!0,TopicId:this.topicId}};this.replaceAttachmentForm.get("attachmentFileToken").value?t.document.FileToken=this.replaceAttachmentForm.get("attachmentFileToken").value:this.replaceAttachmentForm.get("url").value&&(t.document.DocumentUrl=this.replaceAttachmentForm.get("url").value),this.isLoading=!0,this.folderManagementService.editDocument(t).subscribe(function(t){0===t.ErrorCode?e.notificationService.showSuccess("Attachment was replaced","Replace attachment / Add URL"):e.notificationService.showError(t.ErrorCode,"Replace attachment / Add URL"),e.isLoading=!1,e.onClose()})},e.prototype.isValidUrl=function(){var e=/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%\-\/]))?/;return function(t){return e.test(t.value)?null:{notUrl:{value:t.value}}}},e}()},"2+i1":function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i("RGa9"),i("o3mN");var n=function(){function e(e,t,i){this.topicService=e,this.sessionService=t,this.changeDetectorRef=i,this.isLoading=!1}return e.prototype.changeIcon=function(){var e=this;if(!this.isLoading){if(this.isLoading=!0,this.changeDetectorRef.detectChanges(),this.favorite)return this.topicService.deleteFavoriteTopics({siteId:this.sessionService.room.id,favoriteTopics:[this.documentId]}).subscribe(function(t){return e.updateFavorite(t.Result)});this.topicService.setFavoriteTopics({siteId:this.sessionService.room.id,favoriteTopics:[{TopicId:this.documentId,Comments:null}]}).subscribe(function(t){return e.updateFavorite(t.Result)})}},e.prototype.updateFavorite=function(e){this.isLoading=!1,e&&(this.favorite=!this.favorite,this.changeDetectorRef.detectChanges())},e}()},"2Gbm":function(e,t,i){"use strict";i("o3mN");var n=i("SVYi"),o=i("pTjd"),r=i("GRuN"),s=i("dgYu"),c=i("HXRl"),a=i("9j6A"),d=function(e){return e[e.unclaimed=1]="unclaimed",e[e.pending=2]="pending",e[e.approved=3]="approved",e[e.declined=4]="declined",e[e.claimed=5]="claimed",e[e.excluded=6]="excluded",e[e.clarification=7]="clarification",e[e.approvedWithIssues=8]="approvedWithIssues",e[e.inProgress=9]="inProgress",e}({}),u=i("xGRp");i.d(t,"a",function(){return l});var l=function(){function e(e){this.sessionService=e}return e.prototype.isFavoritesActionEnabled=function(e,t){for(var i=!0,o=0;o<e.length;o++){if(this.isPlaceholderDoc(e[o])||this.isMissingDoc(e[o])||this.isDeletedDocument(e[o])||this.isPurgedDocument(e[o]))return!1;var r=s.a.getTopicFieldValue(e[o],n.a.Document.IsFavorite);i=i&&(t?r:!r)}return i},e.prototype.isRealDocuments=function(e,t){var i=this,n=c.b.FolderTreeViewModes,r=!0;return t!==n.ETMF_COMPLETENESS&&t!==n.QUERY_RESOLUTION&&t!==n.QUERY_BY_RECIPIENTS||e.forEach(function(e){if(!(e.TopicId>0&&e.TopicTypeId===i.sessionService.topicTypes.idByName[o.b.Document]))return r=!1,!1}),r},e.prototype.getConvertTypes=function(){return this.sessionService.settings.general.document.conversionFileTypes.get()},e.prototype.isReplaceAttachmentEnabled=function(e,t){var i=e[0];if(!i.Workflows)return!0;var n=i&&i.ESignatureRequest;return i.Workflows.some(function(e){return!!(e&&e.Stages||[]).find(function(e){return e.ApproverData.ClaimStatus===r.a.ClaimedByCurrentUser})})?!this.isRealDocuments(e,t):!this.singleDocSelected(e)||!this.isRealDocuments(e,t)||this.isDocumentClaimedInWorkflow(i)||n},e.prototype.isDocumentClaimedInWorkflow=function(e){return(e&&e.Workflows||[]).find(function(e){return e.Document.Status===d.pending||e.Document.Status===d.clarification})},e.prototype.sendForESignature=function(e,t){return!(this.singleDocSelected(e)&&this.isRealDocuments(e,t)&&(this.sessionService.user.hasAction(u.a.ESignature)||this.sessionService.user.superAdmin))&&this.checkEsignListStatus(e[0].ESignatureRequest,t)},e.prototype.checkEsignListStatus=function(e,t){var i;return t!==c.b.FolderTreeViewModes.DELETED_BY_USER&&(e&&(i=e.StatusId),!(i>0&&i!==a.a.pending&&i!==a.a.error))},e.prototype.singleDeletedDocForAdmin=function(e){return this.singleDocSelected(e)&&this.sessionService.user.adminOrHigher&&e[0].TopicTypeId===this.sessionService.topicTypes.idByName[o.b.DeletedDocument]},e.prototype.singleDocSelected=function(e){return 1===e.length},e.prototype.applicableForOcr=function(e){return!e.find(function(e){var t=+s.a.getTopicFieldValue(e,n.a.Document.OcrStatusId);return null!=t&&-1===t})},e.prototype.deleteDocuments=function(e,t){return!this.isRealDocuments(e,t)||!this.createdBy(e)},e.prototype.createdBy=function(e){var t=this,i=!0;return e.forEach(function(e){if(e.CreatedBy!==t.sessionService.user.details.UserId)return i=!1,!1}),i},e.prototype.isPlaceholderDoc=function(e){return e.TopicTypeId===this.sessionService.topicTypes.idByName[o.b.DocumentPlaceholder]},e.prototype.isDeletedDocument=function(e){return e.TopicTypeId===this.sessionService.topicTypes.idByName[o.b.DeletedDocument]},e.prototype.isPurgedDocument=function(e){return e.TopicTypeId===this.sessionService.topicTypes.idByName[o.b.PurgedDocument]},e.prototype.isMissingDoc=function(e){return e.TopicId<0||e.TopicTypeId===this.sessionService.topicTypes.idByName[o.b.MissingDocument]},e.prototype.canEdit=function(e){return this.isDocumentsReal(e)},e.prototype.isDocumentsReal=function(e){return!e.find(function(e){return!(e.TopicId>0&&e.TopicTypeId===s.a.getTopicFieldValue(e,o.b.Document))})&&!!e.length},e}()},"554q":function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("CcnG"),o=i("ojlA"),r=function(e,t,i,n,o,r,s,c){this.name=e,this.id=t,this.size=i,this.type=n,this.uploadStatus=o,this.parent=r,this.nestingLevel=s,this.checked=c},s=function(){function e(e){this.cd=e,this.close$=new n.n,this.filesArr=[],this.fileId=0,this.currentSort={type:"default",order:"default"}}return Object.defineProperty(e.prototype,"totalCount",{get:function(){return this.filesArr.filter(function(e){return"dir"!==e.type}).length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalSize",{get:function(){return this.filesArr.filter(function(e){return"dir"!==e.type}).reduce(function(e,t){return e+t.size},0)},enumerable:!0,configurable:!0}),e.prototype.dropHandler=function(e){if(e.preventDefault(),e.dataTransfer.items&&e.dataTransfer.items[0].webkitGetAsEntry)for(var t=0;t<e.dataTransfer.items.length;t++){var i=e.dataTransfer.items[t].webkitGetAsEntry();this.scanFiles(i,0)}else if(e.dataTransfer.files.length)for(t=0;t<e.dataTransfer.files.length;t++){var n=e.dataTransfer.files[t],o=new r(n.name,this.fileId++,n.size,this.fileExtension(n.name),"not uploaded","general",0,!1);this.addToFilesArray(o)}else alert("This browser does not support Folder Upload")},e.prototype.fileExtension=function(e){var t=e.match(/\.[^.]*$/g);return t&&t[0]?t[0].slice(1).toLowerCase():""},e.prototype.scanFiles=function(e,t,i){var n=this;if(e.isFile)e.file(function(e){var o=new r(e.name,n.fileId++,e.size,n.fileExtension(e.name),"not uploaded",i||"general",t,!1);n.addToFilesArray(o,i)});else if(e.isDirectory){var o=this,s=new function(e,t,i,n,o,r,s){this.name=e,this.id=t,this.type=i,this.parent=n,this.nestingLevel=o,this.opened=r,this.checked=s}(e.name,this.fileId++,"dir",i||"general",t,!0,!1);this.addToFilesArray(s,i),e.createReader().readEntries(function(e){for(var i=e.length-1;i>=0;i--)o.scanFiles(e[i],t+1,s)})}},e.prototype.getIconName=function(e){var t=o.a.getClassByFileType(e);return"folder-open"===t?"":"fa-"+t},e.prototype.getIconColor=function(e){return o.a.getColorByFileType(e)},e.prototype.getSortIcon=function(e){return e===this.currentSort.type&&"desc"===this.currentSort.order?"fa fa-angle-up":e===this.currentSort.type&&"asc"===this.currentSort.order?"fa fa-angle-down":""},e.prototype.addToFilesArray=function(e,t){if(t){var i=this.filesArr.findIndex(function(e){return e.id===t.id});this.filesArr.splice(i+1,0,e)}else this.filesArr.push(e);this.cd.detectChanges()},e.prototype.dragOverHandler=function(e){e.preventDefault()},e.prototype.handleFiles=function(){for(var e=this.browseInput.nativeElement.files,t=0;t<e.length;t++){var i=e[t],n=new r(i.name,this.fileId++,i.size,this.fileExtension(i.name),"not uploaded","general",0,!1);this.addToFilesArray(n)}},e.prototype.browseFiles=function(){this.browseInput.nativeElement.click()},e.prototype.isFileVisible=function(e){for(var t=e.parent;"general"!==t;){if(!t.opened)return!1;t=t.parent}return!0},e.prototype.rowClick=function(e,t){if("INPUT"!==e.target.tagName&&"LABEL"!==e.target.tagName)switch(t.opened){case!0:case!1:t.opened=!t.opened,this.cd.detectChanges();break;default:this.selectedFile=t}},e.prototype.checkboxClick=function(e,t){var i=e.target.checked;t.checked=i,"dir"===t.type&&this.getChildenOfFolder(t).forEach(function(e){return e.checked=i})},e.prototype.getChildenOfFolder=function(e){for(var t=[],i=0;i<this.filesArr.length;i++){var n=this.filesArr[i];n.parent===e&&(t.push(n),"dir"===n.type&&t.push.apply(t,this.getChildenOfFolder(n)))}return t},e.prototype.sortingClick=function(e){this.currentSort.order=this.currentSort.type===e&&"asc"===this.currentSort.order?"desc":"asc",this.currentSort.type=e,this.sortFiles()},e.prototype.sortFiles=function(){for(var e=this.currentSort.type,t=this.currentSort.order,i=[],n=0;n<this.filesArr.length;n++){var o=this.filesArr[n];0===o.nestingLevel&&(i.push(o),"dir"===o.type&&(o.children=this.getChildenOfFolder(o)))}for(i.sort(function(i,n){var o="string"==typeof i[e]?i[e].toLowerCase():i[e],r="string"==typeof n[e]?n[e].toLowerCase():n[e];return o===r?0:"asc"===t?o>r||void 0===r?1:-1:r>o||void 0===o?1:-1}),n=0;n<i.length;n++)i[n].children&&i[n].children.length&&(i.splice.apply(i,[n+1,0].concat(i[n].children)),delete i[n].children);this.filesArr=i},e.prototype.onClear=function(){this.filesArr=[],this.browseInput.nativeElement.value=""},e.prototype.onClose=function(){this.close$.emit()},e}()},"5ka/":function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("CcnG"),o=function(){function e(){this.documentsActionModalClosed=new n.n,this.isLinkDocumentsModal=!1,this.isCopyDocumentsToRooms=!1,this.isCompareDocumentsDialog=!1,this.isSelectAuditDialog=!1,this.isDocumentsReview=!1,this.isCopyDocsToInvSitesModal=!1,this.isSubmissionDocumentsModal=!1,this.isCreateNewReviewModal=!1,this.isCreateAuditProfileModal=!1}return e.prototype.ngOnInit=function(){switch(this.actionName){case"Link":this.openLinkDocumensModal();break;case"Compare":this.openCompareDialog();break;case"Add to existing review":this.openDocumentsReview();break;case"Create new review":this.openCreateNewReviewModal();break;case"to other Rooms":this.openCopyToRoomsDialog();break;case"Add to Submission Package":this.openSubmissionPackageDialog();break;case"Create Audit Profile":this.openCreateAuditProfileModal();break;case"Add to Audit":this.openSelectAuditDialog();break;case"to Investigative Sites":this.openCopyToInvestigativeSitesModal()}},e.prototype.openCompareDialog=function(){this.isCompareDocumentsDialog=!0},e.prototype.openSelectAuditDialog=function(){this.isSelectAuditDialog=!0},e.prototype.openDocumentsReview=function(){this.isDocumentsReview=!0},e.prototype.openLinkDocumensModal=function(){this.isLinkDocumentsModal=!0},e.prototype.openCopyToRoomsDialog=function(){this.isCopyDocumentsToRooms=!0},e.prototype.openCopyToInvestigativeSitesModal=function(){this.isCopyDocsToInvSitesModal=!0},e.prototype.openSubmissionPackageDialog=function(){this.isSubmissionDocumentsModal=!0},e.prototype.openCreateNewReviewModal=function(){this.isCreateNewReviewModal=!0},e.prototype.openCreateAuditProfileModal=function(){this.isCreateAuditProfileModal=!0},e.prototype.closeModal=function(){this.documentsActionModalClosed.next()},e}()},"9j6A":function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(e){return e[e.cancelled=-1]="cancelled",e[e.pending=1]="pending",e[e.waitingForSigners=2]="waitingForSigners",e[e.complete=3]="complete",e[e.error=4]="error",e[e.decline=5]="decline",e}({})},GRuN:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(e){return e[e.CurrentUserCanClaim=0]="CurrentUserCanClaim",e[e.ClaimedByCurrentUser=1]="ClaimedByCurrentUser",e[e.ClaimedByAnotherUser=2]="ClaimedByAnotherUser",e[e.UnableToClaim=3]="UnableToClaim",e}({})},"J/PT":function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("CcnG"),o=(i("8tIk"),i("vz9p")),r=i("vznZ"),s=(i("HXRl"),function(){function e(e,t){this.folderManagementService=e,this.notificationService=t,this.close$=new n.n,this.isLoading=!1,this.selectedLanguages=["English"]}return e.prototype.ngOnInit=function(){this.languages=Object(o.a)().serverCfg.supportedRecognitionLanguages},e.prototype.ngAfterContentChecked=function(){this.documents&&this.documents.length&&!this.previousData&&(this.previousData=this.documents,this.siteId=this.documents[0].SiteId,this.topicIds=this.documents.map(function(e){return e.TopicId}))},e.prototype.apply=function(){var e=this,t={siteId:this.siteId,topicIds:this.topicIds,fileProcessingTypeId:r.a.OCR,fileProcessingOptions:{OcrOptions:{Languages:this.selectedLanguages}}};this.isLoading=!0,this.folderManagementService.enqueueFile(t).subscribe(function(t){0===t.ErrorCode?e.notificationService.showSuccess("Selected docs were added to the queue","OCR"):e.notificationService.showError(t.ErrorCode,"OCR"),e.isLoading=!1,e.onClose()})},e.prototype.onClose=function(){this.close$.emit(!0)},e}())},JtPj:function(e,t,i){"use strict";i("8tIk");var n=i("vz9p"),o=i("UrId"),r=function(e){return e[e.Unknown=0]="Unknown",e[e.Workflow=1]="Workflow",e[e.Audit=2]="Audit",e[e.Index=3]="Index",e[e.EditDocumentOnline=4]="EditDocumentOnline",e}({}),s=i("dgYu"),c=(i("RGa9"),i("o3mN"),i("SVYi")),a=(i("HXRl"),i("WdNZ"),i("+JNW"));i("jU+G"),i("eaSD"),i.d(t,"a",function(){return d});var d=function(){function e(e,t,i,n,o,r,s){this.sessionService=e,this.folderManagementService=t,this.topicService=i,this.dialogService=n,this.notificationsService=o,this.popupService=r,this.stringFormatPipe=s,this.strings=tiStrings.tiComponents.documents.documentsActions.services.stringsEditOnlineService,this.commonStrings=tiStrings.app.misc,this.URL="assets/pages/editonline/index.html"}return e.prototype.isEditOnlineSupported=function(){var e=this.sessionService.settings.general.document.fileStorageType.get()===o.a.Alfresco;return this.sessionService.user.editorOrHigher&&e&&!this.sessionService.room.info.LegalHoldDueDate},e.prototype.isDocumentEditable=function(e){var t=s.a.getTopicFieldValue(e,c.a.Document.FileName);if(!t)return!1;var i=t.slice(t.lastIndexOf(".")+1).toLowerCase();return-1!==(Object(n.a)().serverCfg.onlyOffice.supportedFileTypes||"").toLowerCase().split(",").indexOf(i)&&1===s.a.getTopicFieldValue(e,c.a.Document.AllowEditDocumentOnline)},e.prototype.isDocumentUnlockable=function(e){return this.sessionService.user.superAdmin&&e.LockedBy!==this.sessionService.user.id&&+s.a.getTopicFieldValue(e,c.a.Document.LockTypeId)===r.EditDocumentOnline},e.prototype.editDocumentOnline=function(e){var t=this;return this.folderManagementService.getDocumentOnlyOfficeInfo({siteId:this.sessionService.room.id,topicId:e.TopicId}).map(function(i){if(i.ErrorCode===a.a.DOCUMENT_IS_EDITED_ONLINE_BY_ANOTHER_USER){var o=i.Result.LockOwnerName?t.stringFormatPipe.transform(t.strings.parallelEditMessage1,i.Result.LockOwnerName):t.strings.parallelEditMessage2;t.dialogService.askQuestionAsTheGodfather(t.commonStrings.warning,o).then(function(e){})}var r=i.Result||{};r.DocumentName=s.a.getTopicFieldValue(e,c.a.Document.DocumentName)||e.TopicName,r.LogoUrl=Object(n.a)().logoUrl,r.RootUrl=window.location.origin,r.User={id:t.sessionService.user.details.UserName,firstname:t.sessionService.user.details.FirstName,lastname:t.sessionService.user.details.LastName,name:t.sessionService.user.details.FullName},r.Lang=t.sessionService.locale,i.Success&&t.openEditor(r)}).toPromise()},e.prototype.unlockDocument=function(e){var t=this;return this.topicService.unlockTopic({siteId:this.sessionService.room.id,topicId:e.TopicId,forceUnlock:!0,lockTypeId:r.EditDocumentOnline}).map(function(e){return e.Success&&t.notificationsService.showInfo(t.strings.successfulUnlockMessage,t.strings.editOnlineTitle),e.Success}).toPromise()},e.prototype.openEditor=function(e){var t=btoa(encodeURI(JSON.stringify(e).replace(/&amp;/gi,"&")));this.popupService.showWindow(this.URL+"?"+t,(new Date).getTime().toString(),"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes")},e}()},LK6Z:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("mrSG"),o=(i("o3mN"),i("1qEl")),r=(i("h4+K"),i("HXRl"),function(e){function t(t,i,n){var o=e.call(this,{updateRequestParamsByFieldNames:!0,updateRequestParamsWithPaging:function(e,t,i){e.first=t,e.limit=i},updateRequestParamsWithSearchQuery:function(e,t){return e.searchQuery=t,Object.assign({},e,{searchQuery:t})}})||this;return o.folderManagementService=t,o.sessionService=i,o.topicSearchService=n,o}return Object(n.c)(t,e),t.prototype.getResponseItemId=function(e){return e.TopicId+""},t.prototype.requestData=function(e){return this.folderManagementService.getDocumentByView(e)},t.prototype.getTotalCount=function(e){return e.Success&&e.Result.TotalRowCount||0},t.prototype.convertResponseToResponseItems=function(e){return e.Success&&e.Result.TopicList||[]},t}(o.a))},Q00r:function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i("mrSG"),o=i("rV5w"),r=i("HXRl"),s=(i("o3mN"),i("36bZ")),c=i("b16z"),a=i("MGOh"),d=i("pTjd"),u=i("dgYu"),l=i("+JNW"),p=function(e){return e[e.None=0]="None",e[e.EmptyFolders=1]="EmptyFolders",e[e.InboxFolder=2]="InboxFolder",e[e.UploadFolder=4]="UploadFolder",e[e.EfaxFolder=8]="EfaxFolder",e[e.ShowInactive=16]="ShowInactive",e[e.ShowIrb=32]="ShowIrb",e}({}),h=function(e){function t(t,i){var n=e.call(this)||this;return n.folderManagementService=t,n.sessionService=i,n}return Object(n.c)(t,e),t.prototype.getData=function(t){return t.apiParams||(t=Object.assign({},t,{showRoot:t.viewMode===r.b.FolderTreeViewModes.BY_INDEX||t.viewMode===r.b.FolderTreeViewModes.MODIFY_INDEX,apiParams:{siteId:this.sessionService.room.id,parentId:null,viewMode:t.viewMode,filterValue:null,foldersIds:null,foldersFilter:this.getFoldersFilter(),docSearchQuery:"",folderSearchQuery:null}})),e.prototype.getData.call(this,t)},t.prototype.getLoader=function(t){return t.showRoot=!1,e.prototype.getLoader.call(this,t)},t.prototype.requestData=function(e){return e.showRoot?o.b.of({ErrorCode:l.a.SUCCESS,Result:[{FolderId:null,FolderName:"Index"}]}):this.folderManagementService.getFolderIndexTree(e.apiParams)},t.prototype.convertResponseToResponseItems=function(e){return e.ErrorCode===l.a.SUCCESS&&e.Result.length?e.Result:[]},t.prototype.convertDataToNodeConfig=function(e,t,i){var n=r.b.FolderTreeViewModes;switch(i.viewMode){case n.BY_COUNTRY:return this.convertDataToNodeConfigByCountry.apply(this,arguments);case n.BY_DOCUMENT_TYPE:return this.convertDataToNodeConfigByDocType.apply(this,arguments);case n.BY_DATE:return this.convertDataToNodeConfigByPostedDate.apply(this,arguments);case n.WORKFLOW_BY_STAGE:case n.BY_REVIEWER:case n.BY_WORKFLOW:case n.MY_REVIEWS:return this.convertDataToNodeConfigMyReviews.apply(this,arguments);case n.MY_SUBMISSIONS:return this.convertDataToNodeConfigMySubmissions.apply(this,arguments);case n.SIGN_DOCS:return this.convertDataToNodeConfigESignature.apply(this,arguments);case n.DELETED_BY_USER:return this.convertDataToNodeConfigDeleted.apply(this,arguments);case n.QUERY_RESOLUTION:case n.QUERY_BY_RECIPIENTS:return this.convertDataToNodeConfigUser.apply(this,arguments);case n.PROCESSED:return this.convertDataToNodeConfigProcessed.apply(this,arguments);case n.ETMF_COMPLETENESS:return this.convertDataToNodeConfigCompleteness.apply(this,arguments);case n.BY_INVESTIGATIVE_SITE:return this.convertDataToNodeConfigInvSite.apply(this,arguments);case n.WORKING_AREA:case n.BY_INDEX:return this.convertDataToNodeConfigIdex.apply(this,arguments);case n.BY_GROUP:case n.BY_SECURITY:return this.convertDataToNodeConfigGroup.apply(this,arguments);case n.MODIFY_INDEX:return this.convertDataToNodeConfigModifyIdex.apply(this,arguments);default:return{text:this.getText(e),additionalText:this.getAdditionalText(e,!1),id:this.getFolderId(e,t)}}},t.prototype.convertDataToNodeConfigByCountry=function(e,t,i){return{text:this.getText(e),icon:"fa-globe",additionalText:this.getAdditionalText(e,!1),id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigByDocType=function(e,t,i){var n=!!e.FolderCount,o=null;if(n){var r=this.getMainParentId(e,t);o=this.getLoader({viewMode:i.viewMode,apiParams:Object.assign({},i.apiParams,{filterValue:(r&&t?r+"|":"")+e.FolderId})})}return{text:this.getText(e),icon:t?"fa-tag":e.FolderId<0?"fa-folder":null,additionalText:this.getAdditionalText(e,n),items:o,id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigByPostedDate=function(e,t,i){var n=function(t,i){return e.FolderName.substring(t,i)};return{text:n(4,6)+"/"+n(6,8)+"/"+n(0,4),icon:"fa-folder",id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigMyReviews=function(e,t,i){return{text:this.getText(e),icon:t?"fa-folder":null,additionalText:t?this.getAdditionalText(e,!t):null,items:this.getDefaultLoader(e,t,i),id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigMySubmissions=function(e,t,i){return{text:this.getText(e),icon:"fa-folder",additionalText:this.getAdditionalText(e,!1),id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigESignature=function(e,t,i){return{text:this.getText(e),icon:"fa-folder",id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigDeleted=function(e,t,i){return{text:-1===e.FolderId?"All":e.FolderName,icon:"fa-folder",id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigUser=function(e,t,i){return{text:this.getText(e),additionalText:this.getAdditionalText(e,!t),items:this.getDefaultLoader(e,t,i),icon:"fa-folder",id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigProcessed=function(e,t,i){return{text:this.getText(e),icon:t?"fa-folder":null,additionalText:null,items:this.getDefaultLoader(e,t,i),id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigCompleteness=function(e,t,i){var n=Object.assign({},i,{level:t?i.level:0,apiParams:Object.assign({},i.apiParams,{filterValue:t?i.apiParams.filterValue+"\\"+e.FolderId:"5\\"+e.FolderId})}),o=!t&&s.a.Study!==e.FolderId||1===n.level&&s.a.InvestigativeSite===t.data.FolderId;return{text:this.getText(e),items:o?this.getLoader(n):null,id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigInvSite=function(e,t,i){var n=!!e.FolderCount,o=null;if(n){var r=this.getInvSiteDocCategoryId(t);o=this.getLoader({viewMode:i.viewMode,apiParams:Object.assign({},i.apiParams,{filterValue:(r?r+"|":"")+e.FolderId})})}return{text:this.getText(e),icon:n?"fa-globe":"fa-flask",additionalText:t?this.getAdditionalText(e,n):null,items:o,id:this.getFolderId(e,t)}},t.prototype.convertDataToNodeConfigIdex=function(e,t,i){var n=!t&&i.showRoot,o=!!e.FolderCount,r=null;return n?r=this.getLoader(i):o&&(r=this.getLoader({viewMode:i.viewMode,apiParams:Object.assign({},i.apiParams,{parentId:e?e.FolderId:0})})),{text:this.getText(e),additionalText:n?null:this.getAdditionalText(e,o),items:r,id:this.getFolderId(e,t),canHaveItems:!0}},t.prototype.convertDataToNodeConfigModifyIdex=function(e,t,i){var n=this.convertDataToNodeConfigIdex(e,t,i);return n.nodeActions=[{text:"add",icon:"plus-circle"},{text:"edit",icon:"pencil"},{text:"delete",icon:"trash-o"}],n},t.prototype.convertDataToNodeConfigGroup=function(e,t,i){return t?i.viewMode===r.b.FolderTreeViewModes.BY_GROUP?this.convertDataToNodeConfigIdex(e,t,i):i.viewMode===r.b.FolderTreeViewModes.BY_SECURITY?{icon:"fa-folder",text:this.getAccessText(e),additionalText:this.getAdditionalText(e,!1),id:this.getFolderId(e,t)}:void 0:{text:this.getGroupText(e),items:this.getDefaultLoader(e,t,i),id:this.getFolderId(e,t)}},t.prototype.getGroupText=function(e){var t=e.FolderId;if(t<-100||0<t){var i=+u.a.getTopicFieldValue(e,"$$GroupTypeId$$");return i===a.a.StudyStartupTeam?"Study Startup Team ["+e.FolderName+"]":i===a.a.StartupSpecialists?"Site Activation Members":e.FolderName}return-1===t?"Administrators Only":-2===t?"Everyone":""},t.prototype.getAccessText=function(e){switch(e.FolderId){case 1:return"Full Access";case 3:return"Read Only";case 4:return"Save";case 5:return"Print";case 6:return"No Watermark";case 7:return"Redacted";default:return e.FolderName}},t.prototype.getInvSiteDocCategoryId=function(e){return e&&e.parent&&e.parent.parent?e.data.FolderId:e?this.getInvSiteDocCategoryId(e.parent):void 0},t.prototype.getMainParentId=function(e,t){return t?this.getMainParentId(t.data,t.parent):e.FolderId},t.prototype.getAdditionalText=function(e,t){var i=null===e.DocCount,n=null===e.TotalDocCount;return i&&n?"":i||n||!t?""+(e.TotalDocCount||e.DocCount||0):e.DocCount+" ("+e.TotalDocCount+")"},t.prototype.getText=function(e){if(e.TopicTypeId){var t=this.sessionService.settings.general.indexOutline;if(t.enableCustomIndexName.get()){var i=this.sessionService.topicTypes.idByName;switch(e.TopicTypeId){case i[d.b.InboxFolder]:return t.inboxFolderName.get();case i[d.b.UploadFolder]:return t.uploadFolderName.get();case i[d.b.eFaxFolder]:return t.eFaxFolderName.get();case i[d.b.IRBUploadFolder]:return t.irbUploadFolderName.get()}}}return(this.sessionService.settings.general.indexOutline.useAutoPrefix.get()&&e.FolderPrefix?e.FolderPrefix+" ":"")+e.FolderName},t.prototype.getFolderId=function(e,t){return t?t.id+"-"+(e.FolderId||0):""+(e.FolderId||0)},t.prototype.getDefaultLoader=function(e,t,i){return t?null:this.getLoader({viewMode:i.viewMode,apiParams:Object.assign({},i.apiParams,{filterValue:e.FolderId})})},t.prototype.getFoldersFilter=function(){var e=this.sessionService.settings.general,t=p.None;return this.sessionService.user.superAdmin&&e.indexOutline.showEmptyFolders.get()&&(t|=p.EmptyFolders),e.inbox.enableInbox.get()&&(t|=p.InboxFolder),t|=p.UploadFolder,e.eFax.enableEFax.get()&&(t|=p.EfaxFolder),t},t}(c.a)},Q8LD:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("CcnG"),o=(i("w172"),i("pWOg"),i("8tIk"),i("RGa9"),i("o3mN"),function(){function e(e,t,i,o,r){this.cartService=e,this.notificationsService=t,this.topicService=i,this.sessionService=o,this.documentsCartActionsService=r,this.close$=new n.n,this.onBeforeAction=new n.n,this.data=[],this.docs=[],this.isDocumentsCartShow=!1,this.isCopyToMenuShow=!1,this.isDocsActionsMenu=!1,this.isSubmissionDocumentsModal=!1,this.cartDocumentsNumber=0,this.numberSelectedDocs=0,this.actionsMenuItems=[{option:"Compare",iconClass:"fa fa-columns",minDocumentsNumber:2},{option:"Merge",iconClass:"fa fa-compress",minDocumentsNumber:1},{option:"Link",iconClass:"fa fa-link",minDocumentsNumber:2},{option:"Add to Audit",iconClass:"fa fa-clipboard",minDocumentsNumber:1},{option:"Create Audit Profile",iconClass:"fa fa-clipboard",minDocumentsNumber:1},{option:"Add to Submission Package",iconClass:"fa fa-clipboard",minDocumentsNumber:1},{option:"Mark as Popular",iconClass:"fa fa-star",minDocumentsNumber:1},{option:"Download",iconClass:"fa fa-download",minDocumentsNumber:1},{option:"Add to existing review",iconClass:"fa fa-list",minDocumentsNumber:1},{option:"Create new review",iconClass:"fa fa-clipboard",minDocumentsNumber:1}],this.copyToMenuItems=[{option:"to other Rooms",iconClass:"fa fa-code-fork",minDocumentsNumber:1},{option:"to Investigative Sites",iconClass:"fa fa-folder-open-o",minDocumentsNumber:1}]}return e.prototype.ngOnInit=function(){var e=this;this.isCartShowSubscription=this.cartService.getDocumentsCartShowEmitter().subscribe(function(t){return e.isDocumentsCartShow=t}),this.configureCartDocuments(this.cartService.getDocuments())},e.prototype.configureCartDocuments=function(e){if(this.cartDocumentsNumber=e.length,this.data=e,0!==this.data.length)for(var t=0;t<this.data.length;t++)void 0===this.data[t].isSelected&&(this.data.isSelected=!1)},e.prototype.setNumberSelectedDocs=function(e){this.numberSelectedDocs=e},Object.defineProperty(e.prototype,"selectedDocs",{get:function(){return this.data.filter(function(e){return!0===e.isSelected})},enumerable:!0,configurable:!0}),e.prototype.closeDocumentsCart=function(){this.cartService.toggleCart(),this.close$.emit(!0)},e.prototype.toggleCopyToMenu=function(){this.isCopyToMenuShow=!this.isCopyToMenuShow,this.isDocsActionsMenu&&(this.isDocsActionsMenu=!this.isDocsActionsMenu)},e.prototype.toggleDocsActionsMenu=function(){this.isDocsActionsMenu=!this.isDocsActionsMenu,this.isCopyToMenuShow&&(this.isCopyToMenuShow=!this.isCopyToMenuShow)},e.prototype.menuItemSelected=function(e){var t=this;this.onBeforeAction.emit(!0),("Mark as Popular"!==e.option?this.documentsCartActionsService.openModal(this.selectedDocs,""+e.option):this.markDocsAsPopular()).then(function(){return t.close$.emit(!0)})},e.prototype.markDocsAsPopular=function(){var e=this;return new Promise(function(t){e.topicService.saveTopicFields({siteId:e.sessionService.room.id,topics:e.selectedDocs}).subscribe(function(i){i.Success&&e.notificationsService.showSuccess("Documents successfully marked as popular.","Popular Documents"),t(!0)})})},e.prototype.onClickOutsideDocsActionsMenu=function(e,t){e.target!==t&&e.target.offsetParent!==t&&(this.isDocsActionsMenu=!1)},e.prototype.onClickOutsideDocsCopyMenu=function(e,t){e.target!==t&&e.target.offsetParent!==t&&(this.isCopyToMenuShow=!1)},e.prototype.ngOnDestroy=function(){this.cartDocumentsSubscription&&this.cartDocumentsSubscription.unsubscribe(),this.isCartShowSubscription&&this.isCartShowSubscription.unsubscribe()},e}())},SGYF:function(e,t,i){"use strict";i.d(t,"a",function(){return f});var n=i("mrSG"),o=i("pabA"),r=i("skcu"),s=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},c=tiStrings.enum.groupTypes,a=tiStrings.tiComponents.documents.documentsActions.components.manageSecurity.stringsManageSecurityStepOne,d=tiStrings.tiComponents.documents.documentsActions.components.manageSecurity.stringsManageSecurityService,u=tiStrings.app.misc,l=function(e){this.isWatermark=!1,this.isRedacted=!1,this.displayName=e.displayName,this.selectedFAOrRead=e.selectedFAOrRead||"",this.isWatermark=e.isWatermark||!1,this.isRedacted=e.isRedacted||!1},p=function(e){function t(t){var i=e.call(this,s({},t))||this;return i.userNames=t.userNames,i.userId=t.userId,i}return Object(n.c)(t,e),t}(l),h=function(e){function t(t){var i=e.call(this,s({},t))||this;return i.groupName=t.groupName,i.groupId=t.groupId,i}return Object(n.c)(t,e),t}(l),f=function(){function e(){this.stepOne={fields:{target:"",subfoldersSecurity:!1,selectedUpdateTypes:""},tree:{expandedKeys:[],checkedKeys:[]}},this.stepTwo={usersData:{data:[],total:0},lastSearchUserName:"",securityData:{data:[],total:0},groupsData:{data:[],total:0},selectedGroupFilter:u.all,groupFilter:[u.all].concat(Object.keys(c)),lastSearchGroupName:"",filteredGroupsData:{data:[],total:0}}}return e.prototype.generateAccessRights=function(e){var t=0;return e.selectedFAOrRead&&(t="FA"===e.selectedFAOrRead?t|r.a.AllRights.value:t|r.a.Read.value),t=e.isWatermark?t|r.a.NotWatermark.value:t&~r.a.NotWatermark.responsibleBit,e.isRedacted?t&~r.a.NotRedacted.responsibleBit:t|r.a.NotRedacted.value},e.prototype.changeTarget=function(e){this.stepOne.fields.target=e},e.prototype.changeSubfoldersSecurity=function(){this.stepOne.fields.subfoldersSecurity=!this.stepOne.fields.subfoldersSecurity},e.prototype.changeUpdateTypes=function(e){this.stepOne.fields.selectedUpdateTypes=e},e.prototype.setExpandedKeysTree=function(e){this.stepOne.tree.expandedKeys=e},e.prototype.setCheckedKeysTree=function(e){this.stepOne.tree.checkedKeys=e},e.prototype.addGroupsBySite=function(e){this.stepTwo.groupsData.data=[{groupId:"everyone",DisplayName:d.everyone,GroupTypeId:"everyone",GroupId:"everyone"}].concat(e.Records),this.stepTwo.groupsData.total=e.TotalRowCount},e.prototype.addGroupToSecurityGrid=function(e){var t,i=this;if((e=e.filter(function(e){return!i.stepTwo.securityData.data.find(function(t){return t.groupId===e.GroupId})})).length){var n=e.map(function(e){return new h({displayName:e.DisplayName,groupName:e.GroupName,groupId:e.GroupId})});return(t=this.stepTwo.securityData.data).push.apply(t,n),this.stepTwo.securityData.total=this.stepTwo.securityData.data.length,n}},e.prototype.removeGroupFromSecurityGrid=function(e){var t=this.stepTwo.securityData.data.findIndex(function(t){return t.groupId===e});-1!==t&&(this.stepTwo.securityData.data.splice(t,1),this.stepTwo.securityData.total=this.stepTwo.securityData.data.length)},e.prototype.sortSecurityGrid=function(e){this.stepTwo.securityData.data=Object(o.d)(this.stepTwo.securityData.data,e),this.stepTwo.securityData.total=this.stepTwo.securityData.data.length},e.prototype.filterGroupGrid=function(e,t){var i=this.stepTwo.lastSearchGroupName,n=c[this.stepTwo.selectedGroupFilter],r=this.stepTwo.groupsData.data.filter(n?function(e){return-1!==e.DisplayName.indexOf(i)&&e.GroupTypeId===n}:function(e){return-1!==e.DisplayName.indexOf(i)});this.stepTwo.filteredGroupsData.data=Object(o.d)(r.length<t?r.slice(-50):r.slice(t,t+50),e),this.stepTwo.filteredGroupsData.total=r.length},e.prototype.sortGroupGrid=function(e){this.stepTwo.filteredGroupsData.data=Object(o.d)(this.stepTwo.filteredGroupsData.data,e),this.stepTwo.filteredGroupsData.total=this.stepTwo.filteredGroupsData.data.length},e.prototype.addUsersToSecurityGrid=function(e){var t,i=this;if((e=e.filter(function(e){return!i.stepTwo.securityData.data.find(function(t){return t.userId===e.UserId})})).length){var n=e.map(function(e){return new p({displayName:e.EmailAddress,userNames:e.EmailAddress,userId:e.UserId})});return(t=this.stepTwo.securityData.data).push.apply(t,n),this.stepTwo.securityData.total=this.stepTwo.securityData.data.length,n}},e.prototype.removeUserFromSecurityGrid=function(e){var t=this.stepTwo.securityData.data.findIndex(function(t){return t.userId===e});-1!==t&&(this.stepTwo.securityData.data.splice(t,1),this.stepTwo.securityData.total=this.stepTwo.securityData.data.length)},e.prototype.addUsersBySite=function(e){this.stepTwo.usersData={data:e.Result.UserList,total:e.Result.TotalRowCount}},e.prototype.getApplyOptions=function(e,t){var i=this.getInitializeApplyOptions();return this.stepOne.fields.selectedUpdateTypes===a.overwriteSecurity&&(i=e>0?1|i:i),"everyone"===t.groupId?32|i:i},e.prototype.getApplyOptionsToRevoke=function(){var e=this.getInitializeApplyOptions();return this.stepOne.fields.selectedUpdateTypes===a.restrictAccess&&(e|=32),e},e.prototype.getInitializeApplyOptions=function(){var e=this.stepOne.fields.selectedUpdateTypes===a.addSecurity?1:0;return this.stepOne.fields.target!==a.selectedFolders||this.stepOne.fields.subfoldersSecurity?this.stepOne.fields.target===a.allFolders?e|=130:this.stepOne.fields.target===a.selectedFolders&&this.stepOne.fields.subfoldersSecurity&&(e|=12):e|=8,e},e}()},TZ5O:function(e,t,i){"use strict";var n=i("CcnG"),o=i("Ip0R"),r=i("2+i1"),s=i("RGa9"),c=i("o3mN");i.d(t,"a",function(){return u});var a=n.Ua({encapsulation:0,styles:[[".main[_ngcontent-%COMP%]{cursor:pointer;color:#d8d8d8;font-size:1rem;padding-right:2px!important}.main.favorite[_ngcontent-%COMP%]{color:#ffbf55}"]],data:{}});function d(e){return n.qb(0,[(e()(),n.Wa(0,0,null,null,2,"div",[],null,[[null,"click"]],function(e,t,i){var n=!0;return"click"===t&&(n=!1!==e.component.changeIcon()&&n),n},null,null)),n.Va(1,278528,null,0,o.k,[n.u,n.v,n.l,n.H],{ngClass:[0,"ngClass"]},null),n.jb(2,{fa:0,"fa-star":1,main:2,favorite:3,"k-icon":4,"k-i-loading":5})],function(e,t){var i=t.component;e(t,1,0,e(t,2,0,!0,!0,!0,i.favorite,i.isLoading,i.isLoading))},null)}var u=n.Sa("ti-favorite-icon-column",r.a,function(e){return n.qb(0,[(e()(),n.Wa(0,0,null,null,1,"ti-favorite-icon-column",[],null,null,null,d,a)),n.Va(1,49152,null,0,r.a,[s.a,c.a,n.i],null,null)],null,null)},{},{},[])},UPeU:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("CcnG"),o=(i("8tIk"),i("o3mN"),i("SVYi")),r=(i("h4+K"),function(){function e(e,t,i){this.topicSearchService=e,this.sessionService=t,this.notificationsService=i,this.close$=new n.n,this.recordIds=[],this.noSelection=!0}return e.prototype.printDocument=function(){var e=this,t=!0===this.allRecords.nativeElement.checked?1:0;this.topicSearchService.printTopics({param:{Filter:{OutputFormat:1},GetDocumentsByViewParams:1===t?{ParentId:this.parentId,Search:"",ViewMode:0}:null,IncludeAllRecords:t,PrintConfig:{FileMissingInfo:{FieldName:o.a.Document.Title,Header:"DOCUMENT ",Text:"IMAGE FILE MISSING FOR "},Limit:100,LimitText:"File limit is reached",PrintErrorInfo:{FieldName:o.a.Document.Title,Header:"DOCUMENT",Text:"PRINT ERROR FOR "},PrintNotAllowedInfo:{FieldName:o.a.Document.Title,Header:"DOCUMENT",Text:"PRINT NOT ALLOWED FOR "},Project:1,SeparatorFields:[{DataIndex:"$Date",Header:"Date"},{DataIndex:"$Time",Header:"Time"},{DataIndex:"$User",Header:"User"},{DataIndex:"$Site",Header:"Room"},{DataIndex:"$Domain",Header:"Domain"},{DataIndex:"Title",Header:"Document Title"}],SeparatorLine:"=================================",UnsupportedExtensionInfo:{FieldName:o.a.Document.Title,Header:"DOCUMENT",Text:"FILE TYPE IS NOT SUPPORTED FOR "}},PrintFormat:"pdf",RecordIds:1===t?[]:this.recordIds},siteId:this.sessionService.room.id}).subscribe(function(t){0===t.ErrorCode&&e.notificationsService.addJob(e.sessionService.room.id,t.Result.JobId,"Print eTMF Documents")}),this.close()},e.prototype.ngOnInit=function(){var e=this;this.recordIds=this.documents.map(function(t){return e.parentId=t.ParentId,t.TopicId}),this.selectedRecords=!!this.recordIds.length,this.selectedAllRecords=!this.recordIds.length,this.noSelection=!this.recordIds.length},e.prototype.close=function(){this.close$.emit()},e}())},VCry:function(e,t,i){"use strict";i.d(t,"b",function(){return n}),i.d(t,"a",function(){return r});var n,o=i("K9Ia");!function(e){e.browse="browse",e.browseWithMetadata="browse_with_metadata",e.review="review",e.preview="preview",e.undock="undock",e.undockInNewWindow="undock_in_new_window"}(n||(n={}));var r=function(){function e(){this.select=new o.b}return e.prototype.getOnSelect=function(){return this.select.asObservable()},e.prototype.setLayout=function(e){localStorage.setItem("documents-default-layout",e),this.select.next(e)},e.prototype.getCurrentLayout=function(){return localStorage.getItem("documents-default-layout")||n.browseWithMetadata},e}()},YcEd:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("CcnG"),o=(i("SGYF"),i("RGa9"),i("o3mN"),function(){function e(e,t,i){this.topicService=e,this.sessionService=t,this.manageSecurityService=i,this.close$=new n.n,this.step=0,this.stringManageSecurityStepOne=tiStrings.tiComponents.documents.documentsActions.components.manageSecurity.stringsManageSecurityStepOne,this.stringManageSecurity=tiStrings.tiComponents.documents.documentsActions.components.manageSecurity.stringsManageSecurity,this.stringsAppMisc=tiStrings.app.misc}return e.prototype.changeStep=function(){this.step=this.step?--this.step:++this.step},e.prototype.isDisableNextBtn=function(){var e=this.manageSecurityService.stepOne;return this.sentRequest||!e.fields.selectedUpdateTypes||!e.fields.target||e.fields.target===this.stringManageSecurityStepOne.selectedFolders&&!e.tree.checkedKeys.length||this.step&&!this.manageSecurityService.stepTwo.securityData.data.length||this.step&&this.manageSecurityService.stepTwo.securityData.data.some(function(e){return!e.selectedFAOrRead})},e.prototype.showSaveBtn=function(){var e=this.manageSecurityService.stepOne;return!!this.step||!!e.fields.target&&e.fields.selectedUpdateTypes===this.stringManageSecurityStepOne.restrictAccess},e.prototype.setAccessRights=function(){var e=this,t=this.manageSecurityService.stepOne.fields,i=t.target&&(t.selectedUpdateTypes===this.stringManageSecurityStepOne.addSecurity||t.selectedUpdateTypes===this.stringManageSecurityStepOne.overwriteSecurity);if(this.sentRequest=!0,i){var n=this.manageSecurityService.stepTwo.securityData.data.map(function(t,i){return{TopicIds:e.manageSecurityService.stepOne.tree.checkedKeys.map(function(e){var t=e.split("-");return t[t.length-1]}).join(","),UserNames:t.userNames||"",ApplyOptions:e.manageSecurityService.getApplyOptions(i,t),AccessRights:e.manageSecurityService.generateAccessRights(t),UserGroupNames:t.groupName||""}});this.topicService.setTopicAccess(o={siteId:this.sessionService.currentRoomId,accessRightInfo:n}).subscribe(function(t){return e.onClose()})}else{var o={siteId:this.sessionService.currentRoomId,applyOptions:this.manageSecurityService.getApplyOptionsToRevoke(),topicIds:this.manageSecurityService.stepOne.tree.checkedKeys.join(","),userNames:this.getUserNamesToRevoke(),groupNames:this.getGroupNamesToRevoke()};this.topicService.revokeTopicAccess(o).subscribe(function(t){return e.onClose()})}},e.prototype.onClose=function(){this.close$.emit()},e.prototype.getUserNamesToRevoke=function(){return this.manageSecurityService.stepOne.fields.selectedUpdateTypes===this.stringManageSecurityStepOne.restrictAccess?"everyone":this.manageSecurityService.stepTwo.securityData.data.map(function(e){return e.userNames}).filter(function(e){return!!e}).join(",")},e.prototype.getGroupNamesToRevoke=function(){return this.manageSecurityService.stepOne.fields.selectedUpdateTypes===this.stringManageSecurityStepOne.restrictAccess?"everyone":this.manageSecurityService.stepTwo.securityData.data.map(function(e){return e.groupName}).filter(function(e){return e}).join(",")},e}())},aqRs:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(e){return e[e.any=0]="any",e[e.ssu=1]="ssu",e[e.etmf=2]="etmf",e[e.collaboration=3]="collaboration",e[e.programsmanagement=4]="programsmanagement",e}({})},hnTP:function(e,t,i){"use strict";var n=i("CcnG"),o=i("P3h3"),r=i("/4FO"),s=i("/GZC"),c=i("0dQg"),a=i("yMiH"),d=i("BsZT"),u=i("1JyZ"),l=i("6fef"),p=i("ihYY"),h=i("Ip0R"),f=i("oUH5"),m=i("GpL1"),g=i("ZYjt");i.d(t,"a",function(){return T});var v=n.Ua({encapsulation:0,styles:[[".document-tooltip[_ngcontent-%COMP%]{border:5px solid #444;min-width:15px;min-height:15px;position:relative}.document-tooltip[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{padding:10px}.attachment-main[_ngcontent-%COMP%]{cursor:pointer;color:#78b7fe;font-size:1rem}"]],data:{}});function S(e){return n.qb(0,[(e()(),n.Wa(0,0,null,null,1,"div",[["class","loading"]],null,null,null,null,null)),(e()(),n.ob(-1,null,["Loading..."]))],null,null)}function y(e){return n.qb(0,[(e()(),n.Wa(0,0,null,null,0,"img",[["alt","Document Preview"]],[[8,"src",4]],null,null,null,null))],null,function(e,t){e(t,0,0,t.component.imageSrc)})}function I(e){return n.qb(0,[(e()(),n.Wa(0,0,null,null,11,"kendo-popup",[["popupClass","document-tooltip"]],null,null,null,o.c,o.b)),n.lb(512,null,s.a,s.a,[]),n.lb(512,null,c.a,c.a,[s.a]),n.lb(512,null,u.a,u.a,[s.a]),n.lb(512,null,r.a,r.a,[s.a,n.B]),n.lb(512,null,a.a,a.a,[s.a,n.B]),n.lb(131584,null,d.a,d.a,[p.b]),n.Va(7,13352960,null,0,l.a,[n.l,c.a,s.a,u.a,r.a,a.a,d.a,n.H,n.B],{popupClass:[0,"popupClass"],offset:[1,"offset"]},null),(e()(),n.Na(16777216,null,0,1,null,S)),n.Va(9,16384,null,0,h.m,[n.T,n.Q],{ngIf:[0,"ngIf"]},null),(e()(),n.Na(16777216,null,0,1,null,y)),n.Va(11,16384,null,0,h.m,[n.T,n.Q],{ngIf:[0,"ngIf"]},null)],function(e,t){var i=t.component;e(t,7,0,"document-tooltip",i.imageOffset),e(t,9,0,!i.imageSrc),e(t,11,0,i.imageSrc)},null)}function A(e){return n.qb(0,[(e()(),n.Wa(0,0,null,null,2,"div",[],[[8,"className",0]],null,null,null,null)),n.Va(1,278528,null,0,h.p,[n.v,n.l,n.H],{ngStyle:[0,"ngStyle"]},null),n.jb(2,{color:0}),(e()(),n.Na(16777216,null,null,1,null,I)),n.Va(4,16384,null,0,h.m,[n.T,n.Q],{ngIf:[0,"ngIf"]},null)],function(e,t){var i=t.component;e(t,1,0,e(t,2,0,i.color)),e(t,4,0,i.visible)},function(e,t){e(t,0,0,n.Ya(1,"fa fa-",t.component.className," attachment-main"))})}var T=n.Sa("ti-document-icon-column",f.a,function(e){return n.qb(0,[(e()(),n.Wa(0,0,null,null,1,"ti-document-icon-column",[],null,[[null,"mouseenter"],[null,"mouseleave"]],function(e,t,i){var o=!0;return"mouseenter"===t&&(o=!1!==n.gb(e,1).onMouseEnter(i)&&o),"mouseleave"===t&&(o=!1!==n.gb(e,1).onMouseLeave(i)&&o),o},A,v)),n.Va(1,180224,null,0,f.a,[m.a,g.c],null,null)],null,null)},{documentId:"documentId",siteId:"siteId",fileName:"fileName"},{},[])},k6dW:function(e,t,i){"use strict";i.d(t,"a",function(){return r}),i("HXRl"),i("o3mN");var n=i("rV5w"),o=i("aqRs"),r=function(){function e(e,t){this.folderManagementService=e,this.sessionService=t,this.movedTopics=new n.c,this.movedTopics$=this.movedTopics.asObservable()}return e.prototype.showConfirmation=function(e){var t=this,i=this.movedTopics$.subscribe(function(n){"yes"!==n&&"no"!==n||("yes"===n&&t.moveBetweenModules(e,"etmf","ssu"),i.unsubscribe())});this.movedTopics.next("confirmation")},e.prototype.moveBetweenModules=function(e,t,i){var n=this;this.movedTopics.next("start moving");var r={moveDocumentData:{DocumentTopics:[],SourceModule:o.a[t],TargetModule:o.a[i]},siteId:this.sessionService.room.id};e.forEach(function(e){r.moveDocumentData.DocumentTopics.push({TopicId:e.TopicId,TopicName:e.TopicName,ParentId:e.ParentId})}),this.folderManagementService.moveDocumentsBetweenModules(r).subscribe(function(e){n.movedTopics.next("finish moving"),0!==e.ErrorCode&&n.movedTopics.next(e)})},e}()},m4EJ:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("CcnG"),o=(i("8tIk"),i("o3mN"),i("pTjd")),r=(i("vCyx"),i("h4+K"),function(){function e(e,t,i,o){this.notificationService=e,this.topicSearchService=t,this.qaService=i,this.sessionService=o,this.close$=new n.n,this.questionTargetIds=[],this.questionParentIds=[],this.isLoading=!1}return e.prototype.ngOnInit=function(){var e=this;this.documents&&this.documents.length&&!this.previousData&&(this.previousData=this.documents,this.siteId=this.documents[0].SiteId,this.documents.forEach(function(t){t.TopicTypeId===e.sessionService.topicTypes.idByName[o.b.Question]||t.TopicTypeId===e.sessionService.topicTypes.idByName[o.b.Answer]?e.questionParentIds.push(t.TopicId):e.questionTargetIds.push(t.TopicId)})),this.setDropdownsData()},e.prototype.setDropdownsData=function(){var e=this;this.isLoading=!0;var t={collectionId:0,fieldListing:"",noOfRows:2147483647,query:"",searchQuery:"",siteId:this.siteId||this.sessionService.currentRoomId,tmfPublishing:{RetrieveFromTmf:!1},topicTypeId:this.sessionService.topicTypes.idByName[o.b.SubjectMatter]},i=Object.assign({},t);i.topicTypeId=this.sessionService.topicTypes.idByName[o.b.QuestionLevels],this.topicSearchService.searchTopics(t).flatMap(function(t){return 0===t.ErrorCode&&(e.questionSubjectMatters=t.Result.TopicList),e.topicSearchService.searchTopics(i)}).subscribe(function(t){0===t.ErrorCode&&(e.issueLevels=t.Result.TopicList),e.isLoading=!1})},e.prototype.apply=function(){var e=this,t={questionCustomFields:[],questionParentIds:this.questionParentIds,questionLevel:this.issueLevelId,questionSubjectMatterId:this.questionSubjectMatterId||null,questionTargetIds:this.questionTargetIds,questionTitle:this.questionTitle,siteId:this.siteId||this.sessionService.currentRoomId};this.isLoading=!0,this.qaService.createQuestion(t).subscribe(function(t){0===t.ErrorCode?e.notificationService.showSuccess("New question was created","Q&A"):e.notificationService.showError(t.ErrorCode,"Q&A"),e.isLoading=!1,e.onClose(t)})},e.prototype.onClose=function(e){this.close$.emit(e)},e}())},nEkz:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("CcnG"),o=(i("o3mN"),i("pXlp"),i("WVK4")),r=function(){function e(e,t){this.sessionService=e,this.userService=t,this.close$=new n.n,this.attachmentsList=[],this.isDocumentSelected=!1,this.recipients=[],this.recipients_cc=[],this.recipients_bcc=[],this.isRecipientsCC=!1,this.isRecipientsBCC=!1,this.isSaveConversation=!1,this.recipientsEmailList=[],this.recipientsCCEmailList=[],this.recipientsBCCEmailList=[],this.subject="",this.files=[],this.fileTokenList=[],this.editOptions={charCounterCount:!1,toolbarButtons:["fontFamily","fontSize","color","bold","italic","underline","strikeThrough","insertLink","align","formatOL","formatUL"],quickInsertTags:[""],height:220,indentMargin:30,placeholderText:"",fontFamilyDefaultSelection:"Open Sans",fontFamilySelection:!0,fontSizeSelection:!0,colorsHEXInput:!1,linkList:[],inkInsertButtons:[],linkAlwaysBlank:!0,linkNoOpener:!1,linkNoReferrer:!1,linkEditButtons:["linkOpen","linkEdit"],fontFamily:{"Arial,Helvetica,sans-serif":"Arial","Georgia,serif":"Georgia","Impact,Charcoal,sans-serif":"Impact","Tahoma,Geneva,sans-serif":"Tahoma","Times New Roman,Times,serif":"Times New Roman","Verdana,Geneva,sans-serif":"Verdana","Open Sans":"Open Sans"}},this.isLoading=!1}return e.prototype.handleFilter=function(e,t){if(e.length>=3)var i=this.userService.getUsersByView({filter:7,limit:15,orderByClause:"[FirstName],[LastName],[UserName] ASC",searchClause:e,siteId:this.sessionService.room.id,start:0,viewTypeId:3}).subscribe(function(e){e.Success&&e.Result.UserList.map(function(e){t.push(e.EmailAddress)}),i.unsubscribe()})},e.prototype.handleFilterRecipient=function(e){this.recipients=[],this.handleFilter(e,this.recipients)},e.prototype.handleFilterRecipientCC=function(e){this.recipients_cc=[],this.handleFilter(e,this.recipients_cc)},e.prototype.handleFilterRecipientBCC=function(e){this.recipients_bcc=[],this.handleFilter(e,this.recipients_bcc)},e.prototype.recipientsCC=function(){this.isRecipientsCC=!this.isRecipientsCC},e.prototype.recipientsBCC=function(){this.isRecipientsBCC=!this.isRecipientsBCC},e.prototype.openCommunication=function(){this.isSaveConversation=!0},e.prototype.sendMail=function(e){this.userService.sendMail(this.sessionService.room.id,{Attachments:this.attachmentsList,AttachmentsPaths:this.fileTokenList,AttachmentsAsLinks:this.isLink,Body:this.template,Subject:this.subject,CarbonCopyGroups:[],CarbonCopyUsers:this.recipientsCCEmailList,RecipientGroups:[],RecipientUsers:this.recipientsEmailList,LinkConfig:{},ProducePdfFile:e,TemplateType:o.a.UserEmail}).subscribe(function(e){}),this.close(),this.closeConversation()},e.prototype.ngOnInit=function(){this.roomId=this.sessionService.room.id,this.saveUrl="https://origami-app.elinext.com:1248/TI/FileUploadService.svc/UploadFile?siteId="+this.roomId,this.attachmentsList=(this.documents||[]).map(function(e){return e.TopicId}),this.isDocumentSelected=!!this.attachmentsList.length},e.prototype.openFileUpload=function(){this.fileUpload.nativeElement.getElementsByTagName("input")[0].click()},e.prototype.onUpload=function(e){this.files.push({id:e.files[0].uid,title:e.files[0].name,format:e.files[0].name,isLoading:!0})},e.prototype.successEventHandler=function(e){var t=this.files.findIndex(function(t){return t.id===e.files[0].uid});this.files[t].isLoading=!1,0===e.response.body.ErrorCode&&this.fileTokenList.push(e.response.body.Result.FileToken)},e.prototype.remove=function(e){var t=this.files.findIndex(function(t){return t.id===e});-1!==t?this.files.splice(t,1):console.log("error doc index!")},e.prototype.changeAsLink=function(e){this.isLink=e},e.prototype.close=function(){this.close$.emit()},e.prototype.closeConversation=function(){this.isSaveConversation=!1},e}()},nfCn:function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n,o=i("oUH5"),r=i("2+i1"),s=i("pTjd"),c=i("SVYi"),a=i("dgYu");!function(e){e.Icon="$$__ICON__$$",e.Favorite="$$__FAVORITE__$$"}(n||(n={}));var d=function(){function e(){}return e.prototype.getColumnsOptions=function(e,t,i){return void 0===t&&(t=[]),void 0===i&&(i=!0),{topicTypes:[s.b.Document],columnsFromTopicTypeTopicFields:i?[s.b.Document]:null,id:e,columns:[this.getIconColumnConfig(),this.getFavoriteColumnConfig()]}},e.prototype.getIconColumnConfig=function(){return{locked:!0,system:!0,name:n.Icon,relatedField:{topicTypeName:s.b.Document,fieldNames:[c.a.Document.FileName]},dataConverter:function(e){return e},renderer:{component:o.a,updater:function(e,t){e.documentId=t.TopicId,e.siteId=t.SiteId,e.fileName=a.a.getTopicFieldValue(t,c.a.Document.FileName)}}}},e.prototype.getFavoriteColumnConfig=function(){return{locked:!0,system:!0,name:n.Favorite,relatedField:{topicTypeName:s.b.Document,fieldNames:[c.a.Document.IsFavorite]},dataConverter:function(e){return e},renderer:{component:r.a,updater:function(e,t){e.documentId=t.TopicId,e.favorite=!!a.a.getTopicFieldValue(t,c.a.Document.IsFavorite)}}}},e}()},oUH5:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("ojlA"),o=(i("GpL1"),function(){function e(e,t){this.documentManagerService=e,this.sanitizer=t,this.visible=!1}return Object.defineProperty(e.prototype,"fileName",{get:function(){return this._fileName},set:function(e){this._fileName=e,this.color=e?n.a.getColorByFileType(e,!1):null,this.className=e?n.a.getClassByFileType(e,!1):null},enumerable:!0,configurable:!0}),e.prototype.showPreview=function(e){var t=this;this.visible||null==this.fileName||(this.visible=!0,this.imageOffset=e,setTimeout(function(){t.visible&&t.documentManagerService.getTopicFilePreview({topicId:t.documentId,siteId:t.siteId}).subscribe(function(e){t.imageSrc=t.sanitizer.bypassSecurityTrustUrl(e.Result),t.previewSubs=null})},1e3))},e.prototype.hidePreview=function(){this.visible=!1},e.prototype.ngOnDestroy=function(){this.hidePreview(),this.previewSubs&&(this.previewSubs.unsubscribe(),this.previewSubs=null)},e.prototype.onMouseEnter=function(e){this.showPreview({left:e.clientX+20,top:e.clientY-45}),e.preventDefault()},e.prototype.onMouseLeave=function(e){this.hidePreview(),e.preventDefault()},e}())},pWOg:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("5ka/"),o=i("CcnG"),r=function(){function e(e){this.resolver=e}return e.prototype.setTemplate=function(e){this.templateRef=e},e.prototype.getTemplate=function(){return this.templateRef},e.prototype.openModal=function(e,t){var i=this;return new Promise(function(o){i.actionName=t,i.templateRef.clear();var r=i.resolver.resolveComponentFactory(n.a);i.componentRef=i.templateRef.createComponent(r),i.componentRef.instance.docs=e,i.componentRef.instance.actionName=t,i.componentRef.instance.documentsActionModalClosed.subscribe(function(){i.componentRef.destroy(),o(!0)})})},e.ngInjectableDef=o.X({factory:function(){return new e(o.Ba(o.k))},token:e,providedIn:"root"}),e}()},qHA9:function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i("6blF"),o=(i("o3mN"),i("HXRl")),r=i("xGRp"),s=(i("Q00r"),i("vDQK"),i("rKMV"),o.b.FolderTreeViewModes),c=function(){function e(e,t,i,n){this.sessionService=e,this.documentsActionsService=t,this.documentsActionsListsService=i,this.documentsTreeDataAdapterService=n}return e.prototype.getViews=function(e,t){var i=this;return n.a.create(function(n){i.createViews(e,t).take(1).subscribe(function(e){var t=[{title:"eTMF",icon:"hospital-o",items:[s.BY_INDEX,s.BY_COUNTRY,s.BY_INVESTIGATIVE_SITE]},{title:"My List",icon:"user-o",items:[s.MY_SUBMISSIONS,s.MY_REVIEWS]},{title:"Queries",icon:"hospital-o",items:[s.WORKFLOW_BY_STAGE,s.BY_REVIEWER,s.BY_WORKFLOW,s.BY_DOCUMENT_TYPE,s.SIGN_DOCS]},{title:"Documents",icon:"file-o",items:[s.QUERY_RESOLUTION,s.QUERY_BY_RECIPIENTS,s.ETMF_COMPLETENESS,s.AUDIT_TO_FIX,s.DOCUMENT_LIFECYCLE]},{title:"Others",icon:"folder-o",items:[s.BY_DATE,s.BY_SECURITY,s.BY_GROUP,s.DELETED_BY_USER,s.PROCESSED]}].filter(function(t){return t.items=t.items.reduce(function(t,i){return e[i]?t.concat([e[i]]):t},[]),t.items.length});n.next(t)})})},e.prototype.createViews=function(e,t){var i=this,o=this.sessionService.user.adminOrHigher,c=this.sessionService.settings.general,a=c.document.enableViewByDocumentType.get(),d=c.module.enableAudit.get(),u=c.module.enableWorkflow.get(),l=this.sessionService.user.adminOrHigher,p=this.sessionService.room.info.IsUserExternalAuditor&&!l,h=this.sessionService.user.editorOrHigher,f=h&&!o&&this.sessionService.user.hasAction(r.a.DocumentManager),m=c.module.enableQueryResolution.get(),g=this.sessionService.user.readerOrHigher,v=!!this.sessionService.settings.security.esignature.useEsignature.get(),S=this.sessionService.room.info.IsUserWorkflowApprover,y=this.sessionService.room.info.IsUserAuditResponseUser,I=this.sessionService.room.info.UseAsSharedWorkspace,A=[[this.documentsActionsService.getExportIndexAction(),this.documentsActionsService.getRefreshIndexAction()]];(this.sessionService.user.adminOrHigher||this.sessionService.user.hasAction(r.a.IndexModification))&&A.splice(0,0,[this.documentsActionsService.getModifyIndexAction()]);var T=function(e,t){return{siteId:i.sessionService.currentRoomId,viewMode:e,unreadOnly:!1,search:t&&t.data?""+t.data.FolderId:"-1"}},D=function(e,t){return{siteId:i.sessionService.currentRoomId,viewMode:e,unreadOnly:!1,parentId:t&&t.parent&&t.parent.data?t.parent.data.FolderId:0,search:t&&t.data?""+t.data.FolderId:"-1"}},b=[{text:"Index",viewMode:s.BY_INDEX,actions:[[this.documentsActionsService.getSearchInIndexAction("Search by folder name")],[{icon:"fa fa-ellipsis-h",items:A}]],treeDropConfig:function(e){return console.log("there should be condition about can we move docs to current folder"),!0},contextActions:this.documentsActionsListsService.getFolderContextActions(),treeNodeToGridParams:function(e){return e&&e.data&&null!=e.data.FolderId?{siteId:i.sessionService.currentRoomId,viewMode:s.BY_INDEX,unreadOnly:!1,search:null,parentId:e&&e.data?e.data.FolderId:0}:null}},{text:"Country",actions:[this.documentsActionsService.getSearchInIndexAction("Search by country name")],viewMode:s.BY_COUNTRY,treeNodeToGridParams:function(e){return T(s.BY_COUNTRY,e)}},{text:"Site",actions:[this.documentsActionsService.getSearchInIndexAction("Search by site name")],viewMode:s.BY_INVESTIGATIVE_SITE,enabled:function(){return c.module.enableETMF.get()},treeNodeToGridParams:function(e){return T(s.BY_INVESTIGATIVE_SITE,e)}},{text:"Submission",viewMode:s.MY_SUBMISSIONS,enabled:function(){return!p&&h},treeNodeToGridParams:function(e){return T(s.MY_SUBMISSIONS,e)}},{text:"Reviews",viewMode:s.MY_REVIEWS,enabled:function(){return!p&&u&&h&&S},treeNodeToGridParams:function(e){return D(s.MY_REVIEWS,e)}},{text:"Workflow",viewMode:s.WORKFLOW_BY_STAGE,enabled:function(){return!p&&u&&(l||f)},treeNodeToGridParams:function(e){return D(s.WORKFLOW_BY_STAGE,e)}},{text:"Reviewer",viewMode:s.BY_REVIEWER,enabled:function(){return!p&&u&&l},treeNodeToGridParams:function(e){return D(s.BY_REVIEWER,e)}},{text:"Status",viewMode:s.BY_WORKFLOW,enabled:function(){return!p&&u&&l},treeNodeToGridParams:function(e){return D(s.BY_WORKFLOW,e)}},{text:"Document Type",actions:[this.documentsActionsService.getSearchInIndexAction("Search by document type name")],viewMode:s.BY_DOCUMENT_TYPE,enabled:function(){return!p&&a},treeNodeToGridParams:function(e){return T(s.BY_DOCUMENT_TYPE,e)}},{text:"eSignature",viewMode:s.SIGN_DOCS,enabled:function(){return!p&&g&&v},treeNodeToGridParams:function(e){return{siteId:i.sessionService.currentRoomId,viewMode:s.SIGN_DOCS,unreadOnly:!1,search:"2",parentId:e.data.FolderId}}},{text:"Sender",viewMode:s.QUERY_RESOLUTION,enabled:function(){return!p&&u&&h&&m&&(l||S||f)},treeNodeToGridParams:function(e){return e.parent?{siteId:i.sessionService.currentRoomId,viewMode:s.QUERY_RESOLUTION,unreadOnly:!1,search:""+e.parent.data.FolderId,parentId:e.data.FolderId}:null}},{text:"Recipient",viewMode:s.QUERY_BY_RECIPIENTS,enabled:function(){return!p&&u&&h&&m&&(l||S||f)},treeNodeToGridParams:function(e){return e.parent?{siteId:i.sessionService.currentRoomId,viewMode:s.QUERY_BY_RECIPIENTS,unreadOnly:!1,search:""+e.parent.data.FolderId,parentId:e.data.FolderId}:null}},{text:"eTMF Completeness",viewMode:s.ETMF_COMPLETENESS,treeNodeToGridParams:function(e){return{siteId:i.sessionService.currentRoomId,viewMode:s.ETMF_COMPLETENESS,unreadOnly:!1,parentId:e&&e.parent&&e.parent.data?e.parent.data.FolderId:0,search:e&&e.data?"5\\"+e.id:"-1"}}},{text:"Document Life Cycle",viewMode:s.DOCUMENT_LIFECYCLE,enabled:function(){return I},treeNodeToGridParams:function(e){return D(s.DOCUMENT_LIFECYCLE,e)}},{text:"Audit Findings",viewMode:s.AUDIT_TO_FIX,enabled:function(){return!p&&d&&y},treeNodeToGridParams:function(e){return D(s.AUDIT_TO_FIX,e)}},{text:"Posted Date",viewMode:s.BY_DATE,treeNodeToGridParams:function(e){return T(s.BY_DATE,e)}},{text:"Security",viewMode:s.BY_SECURITY,enabled:function(){return!p&&l},treeNodeToGridParams:function(e){return{siteId:i.sessionService.currentRoomId,viewMode:s.BY_SECURITY,unreadOnly:!1,search:""+e.data.FolderId,parentId:function e(t){return t.parent?e(t.parent):t.data.FolderId}(e)}}},{text:"Group",viewMode:s.BY_GROUP,enabled:function(){return!p&&l},treeNodeToGridParams:function(e){return{siteId:i.sessionService.currentRoomId,viewMode:s.BY_GROUP,unreadOnly:!1,search:""+e.data.FolderId,parentId:function e(t){return t.parent?e(t.parent):t.data.FolderId}(e)}}},{text:"Deleted Docs",viewMode:s.DELETED_BY_USER,enabled:function(){return!p&&l},treeNodeToGridParams:function(e){return T(s.DELETED_BY_USER,e)}},{text:"Processed Docs",viewMode:s.PROCESSED,enabled:function(){return!p&&h},treeNodeToGridParams:function(e){return{siteId:i.sessionService.currentRoomId,viewMode:s.PROCESSED,unreadOnly:!1,parentId:e&&e.data?e.data.FolderId:-1}}}];return n.a.create(function(n){var o={};b.forEach(function(n){n.enabled&&!n.enabled()||(o[n.viewMode]=i.createView(n,e,t))}),n.next(o)})},e.prototype.createView=function(e,t,i){return{id:""+e.viewMode,text:e.text,nodes:this.documentsTreeDataAdapterService.getData({viewMode:e.viewMode}),dropConfig:e.treeDropConfig?{check:e.treeDropConfig,resultGetter:i}:null,actions:e.actions?{dataGetter:t,items:n.a.of(e.actions)}:null,contextActions:e.contextActions?{dataGetter:t,items:n.a.of(e.contextActions)}:null,value:e}},e}()},rKMV:function(e,t,i){"use strict";i.d(t,"a",function(){return D});var n,o=i("HXRl"),r=(i("k6dW"),i("1uvf")),s=i("J/PT"),c=i("YcEd"),a=i("UPeU"),d=i("wzJP"),u=i("554q"),l=(i("w172"),i("Q8LD")),p=(i("2Gbm"),i("zTiG")),h=i("voD9"),f=(i("8tIk"),i("JtPj"),i("/Wbt")),m=i("dgYu"),g=i("nEkz"),v=i("SXCS"),S=(i("RGa9"),i("m4EJ")),y=(i("o3mN"),i("SVYi")),I=i("vznZ"),A=i("p2NV"),T=i("s/Pl");i("jU+G"),function(e){e.browse="browse",e.browseWithMetadata="browse_with_metadata",e.review="review",e.preview="preview",e.undock="undock",e.undockInNewWindow="undock_in_new_window"}(n||(n={}));var D=function(){function e(e,t,i,n,o,r,s,c,a){this.moveBetweenModulesService=e,this.dialogService=t,this.folderManagementService=i,this.cartService=n,this.notificationsService=o,this.sessionService=r,this.documentsActionsAvailabilityService=s,this.topicService=c,this.editOnlineService=a}return e.prototype.getViewSecurityAction=function(e,t){return{icon:"fa fa-lock",text:"View security",disabled:!0,handler:function(e){return new Promise(function(e){})},resultReceiver:e}},e.prototype.getExportIndexAction=function(e,t){return{icon:"fa fa-upload",text:"Export index",dialogComponent:v.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.config={exportType:"EXPORT_TYPE_INDEX"},e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})}),e.topics=t.gridItemsSelected}}},e.prototype.getModifyIndexAction=function(e,t){return{icon:"fa fa-cog",text:"Modify Index",dialogComponent:p.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.close$.subscribe(function(e){return i({data:e,cancel:!1,close:!0})})}}},e.prototype.getRefreshIndexAction=function(e,t){return{icon:"fa fa-refresh",text:"Refresh",handler:function(){return new Promise(function(e){e({cancel:!1})})},resultReceiver:e}},e.prototype.getSearchInIndexAction=function(e,t,i){return{defaultText:"",fullWidth:!0,placeholderText:e,resultReceiver:t}},e.prototype.getExportFolderArchiveAction=function(e,t){return{icon:"fa fa-download",text:"Export documents",dialogComponent:v.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.config={exportType:f.a.FolderArchive},e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})}),e.topics=t.gridItemsSelected}}},e.prototype.getDocumentMenuAction=function(e,t){return{icon:"fa fa-file",text:"Document",items:[[this.getAddDocumentAction(e,t)],[this.getReplaceAttachmentAction(e,t)],[this.getAskAQuestionAction(e,t),this.getOcrAction(e,t)]]}},e.prototype.getRestoreDocumentsAction=function(e,t){var i=this;return{icon:"fa fa-trash",text:"Restore Documents",disabled:!0,handler:function(e){return new Promise(function(t){var n=e.gridItemsSelected.map(function(e){return{TopicId:e.TopicId,TopicName:null}});i.folderManagementService.restoreDocuments(e.gridItemsSelected[0].SiteId,n).subscribe(function(e){t({cancel:!1}),e.Success&&i.notificationsService.showSuccess("Documents were successfully restored","Restore Documents")})})},resultReceiver:e,updater:function(e,t){e.hidden=t.viewSelectorState.selectedView.value.viewMode!==o.b.FolderTreeViewModes.DELETED_BY_USER||null,e.disabled=!t.gridItemsSelected.length}}},e.prototype.getPurgeDocumentsAction=function(e,t){var i=this;return{icon:"fa fa-trash",text:"Purge",disabled:!0,handler:function(e){return new Promise(function(t){i.dialogService.askText({title:"Permanently Delete Selected Documents",label:"Reason:",btnOkTitle:"Delete",required:!0}).then(function(n){if("yes"!==n.action)return t({cancel:!0});var o={documents:e.gridItemsSelected.map(function(e){return{TopicId:e.TopicId}}),removalReason:n.text,siteId:e.gridItemsSelected[0].SiteId};i.folderManagementService.purgeDocument(o).subscribe(function(e){e.Success&&i.notificationsService.showSuccess("Documents were successfully purged","Purge Documents"),t({cancel:!1,data:e})})})})},resultReceiver:e,updater:function(e,t){e.disabled=!t.gridItemsSelected.length,e.hidden=t.viewSelectorState.selectedView.value.viewMode!==o.b.FolderTreeViewModes.DELETED_BY_USER||null}}},e.prototype.getReplaceAttachmentAction=function(e,t){var i=this;return{icon:"fa fa-paperclip icon-replace-attachment",text:"Replace Attachment",disabled:!0,dialogComponent:r.a,resultReceiver:e,updater:function(e,t){e.disabled=1!==t.gridItemsSelected.length||i.documentsActionsAvailabilityService.isReplaceAttachmentEnabled(t.gridItemsSelected,t.gridRequestParams.viewMode)},dialogInitializer:function(e,t,i){e.document=t.gridItemsSelected[0],e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getAskAQuestionAction=function(e,t){var i=this;return{icon:"fa fa-comment-o icon-ask-a-question",text:"Ask a question",dialogComponent:S.a,resultReceiver:e,updater:function(e,t){e.disabled=!t.gridItemsSelected.length||!i.documentsActionsAvailabilityService.isRealDocuments(t.gridItemsSelected,t.gridRequestParams.viewMode)},dialogInitializer:function(e,t,i){e.documents=t.gridItemsSelected,e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getOcrAction=function(e,t){var i=this;return{icon:"fa fa-crosshairs icon-ocr",text:"OCR",disabled:!0,dialogComponent:s.a,resultReceiver:e,updater:function(e,t){e.disabled=!t.gridItemsSelected.length||!i.documentsActionsAvailabilityService.isRealDocuments(t.gridItemsSelected,t.gridRequestParams.viewMode)||!i.documentsActionsAvailabilityService.applicableForOcr(t.gridItemsSelected)},dialogInitializer:function(e,t,i){e.documents=t.gridItemsSelected,e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getManageSecurityAction=function(e,t){var i=this;return{icon:"fa fa-lock",text:"Manage Security",dialogComponent:c.a,resultReceiver:e,updater:function(e,t){e.disabled=!i.sessionService.user.adminOrHigher},dialogInitializer:function(e,t,i){e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getPrintAction=function(e,t){return{icon:"fa fa-print",text:"Print",dialogComponent:a.a,resultReceiver:e,disabled:!0,updater:function(e,t){e.disabled=!t.gridItemsSelected.length},dialogInitializer:function(e,t,i){e.documents=t.gridItemsSelected,e.close$.subscribe(function(e){return i({cancel:!0,close:!0,data:e})})}}},e.prototype.getEmailAction=function(e,t){return{icon:"fa fa-envelope",text:"Email",dialogComponent:g.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.documents=t.gridItemsSelected,e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getMoveToStartupAction=function(e,t){var i=this;return{icon:"fa fa-files-o",text:"Move to Startup",resultReceiver:e,updater:function(e,t){e.disabled=!t.gridItemsSelected.length},handler:function(e){return new Promise(function(t){i.moveBetweenModulesService.showConfirmation(e.gridItemsSelected),t({cancel:!1})})}}},e.prototype.getImportMenuAction=function(e,t){return{icon:"fa fa-arrow-up",text:"Import",items:[[this.getImportMetadataAction(e,t),this.getImportDocumentsAction(e,t)]]}},e.prototype.getImportMetadataAction=function(e,t){return{icon:"fa fa-file",text:"Metadata",dialogComponent:A.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getImportDocumentsAction=function(e,t){return{icon:"fa fa-upload",text:"Documents",dialogComponent:u.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getExportMenuAction=function(e,t){return{icon:"fa fa-arrow-down",text:"Export",items:[[this.getExportMetadataAction(e,t),this.getExportDocumentsAction(e,t),this.getExportSecurityAction(e,t),this.getRoomArchiveAction(e,t)]]}},e.prototype.getExportMetadataAction=function(e,t){return{icon:"fa fa-file",text:"Metadata",dialogComponent:v.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.config={exportType:f.a.META},e.gridOptions=t&&t.gridRequestParams?{ParentId:t.gridRequestParams.parentId,Search:t.gridRequestParams.search||"",ViewMode:t.gridRequestParams.viewMode}:null,e.topics=t.gridItemsSelected,e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getExportDocumentsAction=function(e,t){return{icon:"fa fa-upload",text:"Documents",dialogComponent:v.a,resultReceiver:e,disabled:!0,updater:function(e,t){e.disabled=!t.viewSelectorState.selectedNodes.length},dialogInitializer:function(e,t,i){e.config={exportType:f.a.Documents},e.gridOptions=t.gridRequestParams?{ParentId:t.gridRequestParams.parentId,Search:t.gridRequestParams.search||"",ViewMode:t.gridRequestParams.viewMode}:null,e.topics=t.gridItemsSelected,e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getExportSecurityAction=function(e,t){return{icon:"fa fa-file",text:"Security",dialogComponent:v.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.config={exportType:f.a.Security},e.gridOptions=t.gridRequestParams?{ParentId:t.gridRequestParams.parentId,Search:t.gridRequestParams.search||"",ViewMode:t.gridRequestParams.viewMode}:null,e.topics=t.gridItemsSelected,e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getRoomArchiveAction=function(e,t){return{icon:"fa fa-upload",text:"Room Archive",dialogComponent:v.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.config={exportType:f.a.SiteArchiveStandard},e.gridOptions=t.gridRequestParams?{ParentId:t.gridRequestParams.parentId,Search:t.gridRequestParams.search||"",ViewMode:t.gridRequestParams.viewMode}:null,e.topics=t.gridItemsSelected,e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getLayoutAction=function(e,t){return{icon:"fa fa-question",text:"Layout",resultReceiver:e,menuComponent:h.a,menuInitializer:function(e,t,i){}}},e.prototype.getCompareDocumentsAction=function(e,t){return{icon:"fa fa-columns",text:"Compare",dialogComponent:d.a,resultReceiver:e,disabled:!0,updater:function(e,t){var i=t.gridItemsSelected.length;e.disabled=!(i&&i>=2&&i<=3)},dialogInitializer:function(e,t,i){e.documents=t.gridItemsSelected,e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getEditOnlineAction=function(e,t){var i=this;return{icon:"fa fa-pencil-square-o",text:"Edit Online",disabled:!0,updater:function(e,t){e.disabled=1!==t.gridItemsSelected.length||i.editOnlineService.isDocumentEditable(t.gridItemsSelected[0])},handler:function(e){return i.editOnlineService.editDocumentOnline(e.gridItemsSelected[0]).then(function(e){return{cancel:!0}})}}},e.prototype.getEditOnlineUnlockAction=function(e,t){var i=this;return{icon:"fa fa-unlock-alt",text:"Unlock Document",disabled:!0,hidden:!this.sessionService.user.superAdmin,updater:function(e,t){e.disabled=1!==t.gridItemsSelected.length||!i.editOnlineService.isDocumentUnlockable(t.gridItemsSelected[0])},handler:function(e){return i.editOnlineService.unlockDocument(e.gridItemsSelected[0]).then(function(e){return{cancel:!e}})}}},e.prototype.getDocumentCartAction=function(e,t){var i,n=this,o="Documents cart",r=this.cartService.getDocuments(),s=function(e,t){return t.length?e+" ("+t.length+")":e};return this.cartService.getDocumentsEmitter().subscribe(function(e){return i.text=s(o,e)}),this.cartService.getDublicatesEmitter().subscribe(function(e){var t=(e||[]).map(function(e){return'"'+e.TopicName+'"'}).join("; ");n.notificationsService.showWarning(t="These documents were already added in cart: "+t,"Documents Cart")}),{icon:"fa fa-shopping-cart",text:s(o,r),menuComponent:l.a,resultReceiver:e,updater:function(e,t){i=e},menuInitializer:function(e,t,i){e.onBeforeAction.subscribe(function(e){return i({cancel:!1,close:!1,data:e,hide:!0})}),e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e,hide:!1})})}}},e.prototype.getAddToDocumentCartAction=function(e,t){var i=this;return{icon:"fa fa-cart-arrow-down icon-add-to-cart",text:"Add to Cart",disabled:!0,updater:function(e,t){e.disabled=!t.gridItemsSelected.length},handler:function(e){return new Promise(function(t){i.cartService.addDocuments(e.gridItemsSelected),t({cancel:!0})})}}},e.prototype.getAddDocumentAction=function(e,t){return{icon:"fa fa-plus-circle icon-add",text:"Add Document",dialogComponent:T.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getAddSingleDocumentAction=function(e,t){return{icon:"fa fa-file icon-add",text:"Add Single Document",dialogComponent:T.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getAddMultipleDocumentAction=function(e,t){return{icon:"fa fa-download icon-add",text:"Add Multiple Documents",dialogComponent:T.a,resultReceiver:e,dialogInitializer:function(e,t,i){e.close$.subscribe(function(e){return i({cancel:!1,close:!0,data:e})})}}},e.prototype.getCopyLinkAction=function(e,t){var i=this;return{icon:"fa fa-clone icon-copy-link",text:"Copy Link",updater:function(e,t){e.disabled=!t.gridItemsSelected.length||!i.documentsActionsAvailabilityService.isRealDocuments(t.gridItemsSelected,t.gridRequestParams.viewMode)},handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getDeleteDocumentAction=function(e,t){var i=this;return{icon:"fa fa-times icon-delete",text:"Delete",updater:function(e,t){e.disabled=i.documentsActionsAvailabilityService.deleteDocuments(t.gridItemsSelected,t.gridRequestParams.viewMode)},handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getAddPlaceholderAction=function(e,t){return{icon:"fa fa-plus-circle icon-add-placeholder",text:"Add Placeholder",handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getEditPlaceholderAction=function(e,t){var i=this;return{icon:"fa fa-trash-o icon-delete-placeholder",text:"Edit Placeholder",updater:function(e,t){e.disabled=1!==t.gridItemsSelected.length||!i.documentsActionsAvailabilityService.isPlaceholderDoc(t.gridItemsSelected[0])},handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getDeletePlaceholderAction=function(e,t){var i=this;return{icon:"fa fa-minus-circle icon-delete",text:"Delete Placeholder",updater:function(e,t){e.disabled=1!==t.gridItemsSelected.length||!i.documentsActionsAvailabilityService.isPlaceholderDoc(t.gridItemsSelected[0])},handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getAddDocumentToPlaceholderAction=function(e,t){var i=this;return{icon:"fa fa-plus-circle icon-add",text:"Add Document",updater:function(e,t){e.disabled=1!==t.gridItemsSelected.length||i.documentsActionsAvailabilityService.isMissingDoc(t.gridItemsSelected[0])||!i.documentsActionsAvailabilityService.isPlaceholderDoc(t.gridItemsSelected[0])},handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getOpenProfileAction=function(e,t){var i=this;return{icon:"fa fa-eye icon-open-profile",text:"Open Profile",updater:function(e,t){e.disabled=1!==t.gridItemsSelected.length||!i.documentsActionsAvailabilityService.isRealDocuments(t.gridItemsSelected,t.gridRequestParams.viewMode)&&!i.documentsActionsAvailabilityService.singleDeletedDocForAdmin(t.gridItemsSelected)},handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getEditProfileAction=function(e,t){return{icon:"fa fa-edit icon-edit-profile",text:"Edit Profile",updater:function(e,t){e.disabled=1!==t.gridItemsSelected.length},handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getAddTofavoriteAction=function(e,t){var i=this;return{icon:"fa fa-star icon-add-to-favorite",text:"Add to favorite",handler:function(t){return new Promise(function(n){i.dialogService.askText({title:"Add Document(s) to Favorite",label:"Comment (optional):",btnOkTitle:"Add to Favorite"}).then(function(o){if("yes"!==o.action)return n({cancel:!0});i.topicService.setFavoriteTopics({siteId:t.gridItemsSelected[0].SiteId,favoriteTopics:t.gridItemsSelected.map(function(e){return{Comments:o.text,TopicId:e.TopicId}})}).subscribe(function(t){return e({cancel:!t.Result})})})})},updater:function(e,t){e.disabled=i.documentsActionsAvailabilityService.isFavoritesActionEnabled(t.gridItemsSelected,!0)}}},e.prototype.getRemoveFromFavoriteAction=function(e,t){var i=this;return{icon:"fa fa-star-o icon-remove-from-favorite",text:"Remove from favorite",handler:function(t){return new Promise(function(n){i.topicService.deleteFavoriteTopics({favoriteTopics:t.gridItemsSelected.map(function(e){return e.TopicId}),siteId:t.gridItemsSelected[0].SiteId}).subscribe(function(t){return e({cancel:!t.Result})})})},updater:function(e,t){e.disabled=i.documentsActionsAvailabilityService.isFavoritesActionEnabled(t.gridItemsSelected,!1)}}},e.prototype.getConvertNonPdfToPDFAction=function(e,t){var i=this;return{icon:"fa fa-file-pdf-o icon-convert-to-pdf",text:"Convert Non PDF to PDF",updater:function(e,t){var n=t.gridItemsSelected[0],o=!0;if(1===t.gridItemsSelected.length){var r=m.a.getTopicFieldValue(n,y.a.Document.FileName),s=r?r.split(".").pop().toLowerCase():"",c="pdf"===s,a=!!m.a.getTopicFieldValue(n,y.a.Document.ConvertedFile),d=-1===i.documentsActionsAvailabilityService.getConvertTypes().indexOf(s);o=!i.documentsActionsAvailabilityService.isRealDocuments(t.gridItemsSelected,t.gridRequestParams.viewMode)||c||a||d}e.disabled=o},handler:function(e){return new Promise(function(t){i.folderManagementService.enqueueFile({fileProcessingTypeId:I.a.NonPDFtoPDF,fileProcessingOptions:null,siteId:e.gridItemsSelected[0].SiteId,topicIds:e.gridItemsSelected.map(function(e){return e.TopicId})}).subscribe(function(e){e.Success?i.notificationsService.showSuccess("Selected docs were added to the queue","Convert non PDF to PDF"):i.notificationsService.showError(e.ErrorCode,"Convert non PDF to PDF"),t({cancel:!1})})})}}},e.prototype.getSendForESignatureAction=function(e,t){var i=this;return{icon:"fa fa-pencil-square-o icon-send-esignature",text:"Send for E-Signature",updater:function(e,t){e.disabled=i.documentsActionsAvailabilityService.sendForESignature(t.gridItemsSelected,t.gridRequestParams.viewMode)},handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getCancelESignatureAction=function(e,t){return{icon:"fa fa-pencil-square-o icon-cancel-esignature",text:"Cancel E-Signature",updater:function(e,t){e.disabled=!0},handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getAddToReviewAction=function(e,t){return{icon:"fa fa-inbox icon-add-to-review",text:"Add to Review",handler:function(e){return new Promise(function(e){e({cancel:!0})})}}},e.prototype.getRelatedDocumentsAction=function(e,t){var i=this;return{icon:"fa fa-code-fork icon-related-documents",text:"Related documents",handler:function(e){return new Promise(function(e){e({cancel:!0})})},updater:function(e,t){e.disabled=1!==t.gridItemsSelected.length||!i.documentsActionsAvailabilityService.isRealDocuments(t.gridItemsSelected,t.gridRequestParams.viewMode)}}},e}()},skcu:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n={Read:{value:1,responsibleBit:1},Edit:{value:3,responsibleBit:2},Save:{value:5,responsibleBit:4},Print:{value:9,responsibleBit:8},AllRights:{value:127,responsibleBit:16},NotWatermark:{value:32,responsibleBit:32},NotRedacted:{value:64,responsibleBit:64}}},vDQK:function(e,t,i){"use strict";i.d(t,"a",function(){return s}),i("rKMV"),i("o3mN"),i("JtPj"),i("yg+0");var n=i("HXRl"),o=i("xGRp"),r=i("eHq/"),s=function(){function e(e,t,i,n){this.documentsActionsService=e,this.sessionService=t,this.editOnlineService=i,this.gridViewActionsService=n}return e.prototype.getFolderContextActions=function(){return[[this.documentsActionsService.getAddSingleDocumentAction(),this.documentsActionsService.getAddMultipleDocumentAction()],[this.documentsActionsService.getViewSecurityAction()],[this.documentsActionsService.getExportIndexAction(),this.documentsActionsService.getExportFolderArchiveAction()]]},e.prototype.getFolderActions=function(e,t){var i=[];return(this.sessionService.user.adminOrHigher||this.sessionService.user.hasAction(o.a.IndexModification))&&i.push(this.documentsActionsService.getModifyIndexAction(e,t)),i.push(this.documentsActionsService.getExportIndexAction(e,t),this.documentsActionsService.getRefreshIndexAction(e,t)),i},e.prototype.getMainToolbarActions=function(e,t,i,o){var s=[this.gridViewActionsService.getGridViewMenuAction(i,function(e){return e.grid.viewHelper})],c=[this.documentsActionsService.getAddToDocumentCartAction(i,o),this.documentsActionsService.getDocumentCartAction(i,o)],a=n.b.FolderTreeViewModes;switch(e){case a.DELETED_BY_USER:s.push(this.documentsActionsService.getRestoreDocumentsAction(function(e){e.cancel||t.refreshGrid()},o),this.documentsActionsService.getPurgeDocumentsAction(i,o),this.documentsActionsService.getImportMenuAction(i,o),this.documentsActionsService.getExportMenuAction(i,o));break;case a.BY_INDEX:case a.BY_DOCUMENT_TYPE:case a.MY_SUBMISSIONS:case a.BY_COUNTRY:case a.BY_DATE:case a.BY_REVIEWER:case a.MY_REVIEWS:case a.PROCESSED:case a.BY_GROUP:case a.BY_SECURITY:s.push(this.documentsActionsService.getDocumentMenuAction(i,o),this.documentsActionsService.getManageSecurityAction(i,o),this.documentsActionsService.getMoveToStartupAction(i,o),this.documentsActionsService.getImportMenuAction(i,o),this.documentsActionsService.getExportMenuAction(i,o));break;case a.ETMF_COMPLETENESS:s.push(this.documentsActionsService.getAddPlaceholderAction(i,o),this.documentsActionsService.getAddDocumentAction(i,o),this.documentsActionsService.getExportMenuAction(i,o))}return this.sessionService.settings.general.document.enableEmail.get()&&s.push(this.documentsActionsService.getEmailAction(i,o)),((this.sessionService.user.details.RoleLevel===r.a.READER||this.sessionService.user.details.RoleLevel===r.a.EDITOR)&&this.sessionService.settings.general.document.enablePrint.get()||this.sessionService.user.details.RoleLevel>r.a.EDITOR)&&s.push(this.documentsActionsService.getPrintAction(i,o)),this.editOnlineService.isEditOnlineSupported()&&(s.push(this.documentsActionsService.getEditOnlineAction(i,o)),this.sessionService.user.superAdmin&&s.push(this.documentsActionsService.getEditOnlineUnlockAction(i,o))),s.push(this.documentsActionsService.getLayoutAction(i,o),this.documentsActionsService.getCompareDocumentsAction(i,o)),[s,c]},e.prototype.getContextMenuActions=function(e,t,i){var o=n.b.FolderTreeViewModes;switch(i){case o.SSU_BY_DOCUMENT_TYPE:case o.SSU_BY_DATE:case o.AUDIT_FINDINGS:case o.AUDIT_TO_FIX:case o.QUERY_BY_RECIPIENTS:case o.AUDIT_QUERY_BY_RECIPIENTS:case o.QUERY_RESOLUTION:case o.AUDIT_QUERY:case o.MY_AUDIT_AUDITED:case o.BY_AUDITOR_AUDITED:case o.BY_AUDITOR_RESOLVED:case o.BY_REVIEWER:case o.BY_WORKFLOW:case o.WORKFLOW_BY_STAGE:case o.MY_REVIEWS:return[[this.documentsActionsService.getAddDocumentAction(e,t),this.documentsActionsService.getCopyLinkAction(e,t),this.documentsActionsService.getDeleteDocumentAction(e,t),this.documentsActionsService.getManageSecurityAction(e,t)],[this.documentsActionsService.getOpenProfileAction(e,t),this.documentsActionsService.getEditProfileAction(e,t),this.documentsActionsService.getReplaceAttachmentAction(e,t)],[this.documentsActionsService.getAddToDocumentCartAction(e,t),this.documentsActionsService.getAddTofavoriteAction(e,t),this.documentsActionsService.getRemoveFromFavoriteAction(e,t)],[this.documentsActionsService.getOcrAction(e,t),this.documentsActionsService.getConvertNonPdfToPDFAction(e,t)],[this.documentsActionsService.getSendForESignatureAction(e,t),this.documentsActionsService.getAddToReviewAction(e,t),this.documentsActionsService.getAskAQuestionAction(e,t),this.documentsActionsService.getRelatedDocumentsAction(e,t)]];case o.BY_INDEX:case o.SIGN_DOCS:return[[this.documentsActionsService.getAddDocumentAction(e,t),this.documentsActionsService.getCopyLinkAction(e,t),this.documentsActionsService.getDeleteDocumentAction(e,t),this.documentsActionsService.getManageSecurityAction(e,t)],[this.documentsActionsService.getOpenProfileAction(e,t),this.documentsActionsService.getEditProfileAction(e,t),this.documentsActionsService.getReplaceAttachmentAction(e,t)],[this.documentsActionsService.getAddToDocumentCartAction(e,t),this.documentsActionsService.getAddTofavoriteAction(e,t),this.documentsActionsService.getRemoveFromFavoriteAction(e,t)],[this.documentsActionsService.getOcrAction(e,t),this.documentsActionsService.getConvertNonPdfToPDFAction(e,t)],[this.documentsActionsService.getSendForESignatureAction(e,t),this.documentsActionsService.getCancelESignatureAction(e,t),this.documentsActionsService.getAddToReviewAction(e,t),this.documentsActionsService.getAskAQuestionAction(e,t),this.documentsActionsService.getRelatedDocumentsAction(e,t)]];case o.ETMF_COMPLETENESS:return[[this.documentsActionsService.getCopyLinkAction(e,t)],[this.documentsActionsService.getAddPlaceholderAction(e,t),this.documentsActionsService.getEditPlaceholderAction(e,t),this.documentsActionsService.getDeletePlaceholderAction(e,t)],[this.documentsActionsService.getAddToDocumentCartAction(e,t),this.documentsActionsService.getAddTofavoriteAction(e,t),this.documentsActionsService.getRemoveFromFavoriteAction(e,t)],[this.documentsActionsService.getConvertNonPdfToPDFAction(e,t)],[this.documentsActionsService.getSendForESignatureAction(e,t),this.documentsActionsService.getCancelESignatureAction(e,t),this.documentsActionsService.getAddToReviewAction(e,t),this.documentsActionsService.getAskAQuestionAction(e,t),this.documentsActionsService.getRelatedDocumentsAction(e,t)]];case o.DELETED_BY_USER:return[[this.documentsActionsService.getRestoreDocumentsAction(e,t),this.documentsActionsService.getPurgeDocumentsAction(e,t)]];default:return[[this.documentsActionsService.getCopyLinkAction(e,t),this.documentsActionsService.getDeleteDocumentAction(e,t),this.documentsActionsService.getManageSecurityAction(e,t)],[this.documentsActionsService.getOpenProfileAction(e,t),this.documentsActionsService.getEditProfileAction(e,t),this.documentsActionsService.getReplaceAttachmentAction(e,t)],[this.documentsActionsService.getAddToDocumentCartAction(e,t),this.documentsActionsService.getAddTofavoriteAction(e,t),this.documentsActionsService.getRemoveFromFavoriteAction(e,t)],[this.documentsActionsService.getOcrAction(e,t),this.documentsActionsService.getConvertNonPdfToPDFAction(e,t)],[this.documentsActionsService.getSendForESignatureAction(e,t),this.documentsActionsService.getAddToReviewAction(e,t),this.documentsActionsService.getAskAQuestionAction(e,t),this.documentsActionsService.getRelatedDocumentsAction(e,t)]]}},e}()},voD9:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("VCry"),o=function(){function e(e){this.documentsLayoutsService=e,this.layouts=n.b}return e.prototype.ngOnInit=function(){this.selectedLayout=this.documentsLayoutsService.getCurrentLayout()},e.prototype.selectLayout=function(e){this.selectedLayout=e,this.documentsLayoutsService.setLayout(e)},e}()},vznZ:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(e){return e[e.PageCount=1]="PageCount",e[e.Optimization=2]="Optimization",e[e.OCR=3]="OCR",e[e.NonPDFtoPDF=4]="NonPDFtoPDF",e[e.PDFFix=5]="PDFFix",e[e.eFax=6]="eFax",e[e.ResolveDocType=7]="ResolveDocType",e[e.PublishReadyForEtmf=8]="PublishReadyForEtmf",e}({})},w172:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("CcnG"),o=function(){function e(){this.documents=[],this.isDocumentsCartShow=!1,this.documentsEmitter=new n.n,this.duplicatesEmitter=new n.n,this.documentsCartShowEmitter=new n.n}return e.prototype.addDocuments=function(e){var t=this,i=[];e.forEach(function(e){var n=-1;t.documents.forEach(function(t,i){return t===e?n=i:null}),-1===n?t.documents.push(e):i.push(e)}),i.length>0&&this.duplicatesEmitter.emit(i),e.length!==i.length&&this.documentsEmitter.emit(this.documents)},e.prototype.getDocuments=function(){return this.documents},e.prototype.updateDocumentsList=function(e){this.documents=e,this.documentsEmitter.emit(this.documents)},e.prototype.getDocumentsEmitter=function(){return this.documentsEmitter},e.prototype.getDublicatesEmitter=function(){return this.duplicatesEmitter},e.prototype.getDocumentsCartShowEmitter=function(){return this.documentsCartShowEmitter},e.prototype.toggleCart=function(e){this.isDocumentsCartShow=!0===e||!1===e?e:!this.isDocumentsCartShow,this.documentsCartShowEmitter.emit(this.isDocumentsCartShow)},e}()},wzJP:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("CcnG"),o=(i("GpL1"),function(){function e(e,t){this.documentManagerService=e,this.sanitizer=t,this.isCompareDialog=new n.n,this.comparableData=[],this.close$=new n.n,this.fields=[{selector:"$$CodingTypeName$$",name:"Category"},{selector:"Country",name:"Country"},{selector:"$$DocumentTypeName$$",name:"Document Type"},{selector:"Comments",name:"Comments"},{selector:"$$FileName$$",name:"FileName"},{selector:"Document Date",name:"Document Date"}]}return e.prototype.onClose=function(){this.close$.emit(),this.isCompareDialog.emit()},e.prototype.ngOnInit=function(){var e=this;this.documents=this.documents.slice(0,3),this.setComparableData(this.documents);var t=this.setViewerParams(this.documents);this.documentManagerService.getCompareViewerUrl(t.siteId,t.topics).subscribe(function(t){e.safeUrl=e.sanitizer.bypassSecurityTrustResourceUrl(t)})},e.prototype.setComparableData=function(e){for(var t=this.fields,i=0;i<t.length;i++){for(var n=[t[i].name],o=0;o<e.length;o++){var r=this.getFieldValueForDocument(t[i].selector,o);n.push(r)}this.comparableData.push(n)}},e.prototype.setViewerParams=function(e){var t={siteId:null,topics:[]};return t.siteId=e[0].SiteId,e.forEach(function(e){t.topics.push(e.TopicId)}),t},e.prototype.getFieldValueForDocument=function(e,t){var i=this.documents[t].TopicFields.find(function(t){return t.FieldName===e});return i?i.Fieldvalue:""},e.prototype.setTdColor=function(e,t){var i=this.comparableData[e][t];if(0===t)return"transparent";for(var n=1;n<this.comparableData[e].length;n++)if(n!==t&&this.comparableData[e][n]===i)return"#B8E986";return"#FF7889"},e}())},"yg+0":function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i("ZvKB"),o=i("gCqT"),r=i("mdxD"),s=i("6blF"),c=i("+u11"),a=i("Xkg1"),d=i("WdNZ"),u=i("CcnG"),l=function(){function e(e){this.gridSettingsService=e,this.strings=tiStrings.shared.grid.services.gridViewActionsService}return e.prototype.getGridViewMenuAction=function(e,t){var i=this;return{icon:"fa fa-eye",text:"",itemsGetter:function(n){return s.a.create(function(o){i.gridSettingsService.getViews(t(n).id).subscribe(function(n){var r=[[i.getSaveViewAction(e,t),i.getRevertDefaultViewAction(e,t)],[i.getShowAllViewsAction(e,t)],[i.getConfigurationAction(e,t),i.getAddFilterAction(e,t)]];n&&r.push(n.map(function(n){return i.getViewAction(n,e,t)})),o.next(r)})})}}},e.prototype.getSaveViewAction=function(e,t){return{icon:"fa fa-save",text:this.strings.saveView,dialogComponent:r.a,dialogInitializer:function(e,i,n){var o=t(i),r=o.prepareCurrentViewForUpdate();e.canSaveAsNew=!!r.id,e.onlyCanSaveAsNew=!r.isCreatedByCurrentUser,e.data=r.data,e.close.subscribe(function(t){if(!t)return n({cancel:!0,close:!0,data:t});e.isLoading=!0,o.saveCurrentView(t.data,t.saveAsNew).subscribe(function(){n({cancel:!t,close:!0,data:t})})})},resultReceiver:e,updater:function(e,i){var n=t(i);e.disabled=!n.id||!n.currentView}}},e.prototype.getRevertDefaultViewAction=function(e,t){return{icon:"fa fa-undo",text:this.strings.revertToDefault,disabled:!0,handler:function(e){return new Promise(function(i){t(e).revertToDefaultView(),i({cancel:!1})})},resultReceiver:e,updater:function(e,i){var n=t(i);e.disabled=!n.id||!n.currentView||!n.currentView.id}}},e.prototype.getShowAllViewsAction=function(e,t){return{icon:"fa fa-list-ul",text:this.strings.showAllViews,dialogComponent:o.a,dialogInitializer:function(e,i,n){var o=t(i);e.category=o.id,e.close.subscribe(function(e){e&&o.setViewAsCurrent(e.id),n({cancel:!e,close:!0,data:e})})},resultReceiver:e,updater:function(e,i){var n=t(i);e.disabled=!n.id}}},e.prototype.getConfigurationAction=function(e,t){return{icon:"fa fa-columns",text:this.strings.updateColumns,dialogComponent:n.a,resultReceiver:e,dialogInitializer:function(e,i,n){var o=t(i),r=o.currentView,s=[],c=[];o.allColumns.forEach(function(e){if(!e.system){c.push({name:e.name,title:e.originalTitle,width:e.width});var t=(r.columns||[]).find(function(t){return t.name===e.name});t&&((t=Object.assign({},t)).title=t.title||e.originalTitle,null==t.width&&null!==e.width&&(t.width=e.width),s.push(t))}}),e.availableColumns=c,e.selectedColumns=s,e.close.subscribe(function(e){e&&(r.columns=e,o.refresh()),n({cancel:!e,close:!0,data:e})})},updater:function(e,i){var n=t(i);e.disabled=!n.id}}},e.prototype.getAddFilterAction=function(e,t){return{icon:"fa fa-filter",text:this.strings.updateFilter,dialogComponent:a.a,resultReceiver:e,dialogInitializer:function(e,i,n){var o=t(i),r=o.currentView;e.items=o.allFilters,e.value=r.filter,e.close.subscribe(function(e){e&&(r.filter=e,o.refresh()),n({cancel:!e,close:!0,data:e})})},updater:function(e,i){var n=t(i);e.disabled=!n.id}}},e.prototype.getViewAction=function(e,t,i){return{icon:"fa fa-eye",text:Object(d.b)(this.strings.view,e.title),group:"views",handler:function(t,n){return new Promise(function(o){i(t).setViewAsCurrent(e.id),n(!0),o({cancel:!1,data:e})})},resultReceiver:t,updater:function(t,n){var o=i(n);t.selected=o.currentView&&o.currentView.id===e.id}}},e.ngInjectableDef=u.X({factory:function(){return new e(u.Ba(c.a))},token:e,providedIn:"root"}),e}()},zTiG:function(e,t,i){"use strict";var n=i("CcnG"),o=(i("RGa9"),i("o3mN"),function(e){return e[e.Create=1]="Create",e[e.Rename=2]="Rename",e[e.Copy=3]="Copy",e[e.Move=4]="Move",e[e.Delete=5]="Delete",e[e.PostFile=6]="PostFile",e}({})),r=i("pTjd"),s=(i("Q00r"),i("HXRl"));i("h4+K"),i.d(t,"a",function(){return a});var c=s.b.FolderTreeViewModes,a=function(){function e(e,t,i,o,r,s){this.topicService=e,this.sessionService=t,this.topicSearchService=i,this.modifyIndexViewService=o,this.folderManagementService=r,this.renderer=s,this.close$=new n.n,this.isConfirmationOpen=!1,this.isLoading=!1,this.isActionClick=!1,this.isDraggableNode=!1,this.isDropped=!1,this.dragType="move",this.nodeIdCounter=-1,this.treeActions=[],this.folderActions=[],this.isNewNode=!1,this.isIndexLocked=!1,this.nodes=this.modifyIndexViewService.getData({viewMode:c.MODIFY_INDEX})}return e.prototype.ngOnInit=function(){var e=this,t={siteId:this.sessionService.room.id,topicTypeId:this.sessionService.topicTypes.idByName[r.b.RootFolder]};this.isLoading=!0,this.topicSearchService.searchTopics(t).flatMap(function(t){return e.topicOptions={siteId:e.sessionService.room.id,topicId:t.Result.TopicList[0].TopicId},e.topicService.lockTopic(e.topicOptions)}).subscribe(function(t){e.isLoading=!1,t.Success||(e.isIndexLocked=!0,e.lockedAdministrator=t.Result?'("'+t.Result+'")':""),e.modifyIndexTree.nativeElement.getElementsByTagName("li")[0].ondrop=function(t){e.isDropped=!0,t.path["li"===t.path[3].localName?1:0].click(),e.onDropNode(t)}})},e.prototype.onClose=function(){var e=this;this.isLoading=!0,this.topicService.unlockTopic(this.topicOptions).subscribe(function(){e.isLoading=!1,e.close$.emit()})},e.prototype.onNodeClick=function(e){},e.prototype.onDropNode=function(e){},e.prototype.checkDropNode=function(e,t){},e.prototype.setSingleNodeStyles=function(){this.renderer.removeClass(this.draggableNode.path[5].children[0].children[1].children[0],"fa-folder-open"),this.renderer.addClass(this.draggableNode.path[5].children[0].children[1].children[0],"fa-folder"),this.renderer.removeChild(this.draggableNode.path[5].children[0],this.draggableNode.path[5].children[0].children[0]),this.renderer.removeChild(this.draggableNode.path[5],this.draggableNode.path[5].children[1])},e.prototype.onTreeNodeUserAction=function(e){if(this.newElement)this.renderer.selectRootElement(this.newElement).focus();else if(this.action){switch(this.isActionClick=!0,this.action){case"add":this.prefix="",this.newNodeParentId=this.nodeElements.path[4].getAttribute("id")?+this.nodeElements.path[4].getAttribute("id"):e.selectedNodes[0].id,this.newNodeId=this.nodeIdCounter,this.prepareAddField();break;case"edit":this.nodeElements.path[4].getAttribute("id")?this.newNodeId=+this.nodeElements.path[4].getAttribute("id"):(this.newNodeId=e.selectedNodes[0].id,this.prefix=e.selectedNodes[0].data.FolderPrefix,this.currentNodeValue=this.nodeElements.path[2].children[1].innerText.replace(this.prefix+" ","")),this.prepareEditField();break;case"delete":this.isDraggableNode=!1,this.newNodeId=this.nodeElements.path[3].getAttribute("id")?+this.nodeElements.path[4].getAttribute("id"):e.selectedNodes[0].id,this.openConfirmation()}this.action=""}else this.prefix=e.selectedNodes[0].data.FolderPrefix},e.prototype.onNodeActionClick=function(e){this.newElement||(this.action=e.action,this.nodeElements=e.event)},e.prototype.prepareEditField=function(){var e=this;this.currentNodeValue||(this.currentNodeValue=this.nodeElements.path[2].children[1].innerText),this.changeableNode=this.nodeElements.path[3].children[1===this.nodeElements.path[3].children.length?0:1],this.renderer.removeChild(this.nodeElements.path[3],this.nodeElements.path[3].children[1===this.nodeElements.path[3].children.length?0:1]),this.newElement=this.renderer.createElement("input"),this.renderer.appendChild(this.nodeElements.path[3],this.newElement),this.renderer.setStyle(this.newElement,"width","95%"),this.renderer.setStyle(this.newElement,"margin-left","15px"),this.renderer.setAttribute(this.newElement,"value",this.currentNodeValue),this.currentNodeValue="",this.renderer.selectRootElement(this.newElement).focus(),this.renderer.listen(this.newElement,"keyup.enter",function(){e.confirmFieldChange(!1),e.isNewNode?(e.isNewNode=!1,e.addTreeAction({Action:o.Create,TopicId:e.newNodeId,Value:e.newNodeValue,ParentId:e.newNodeParentId})):e.addTreeAction({Action:o.Rename,TopicId:e.newNodeId,Value:e.newNodeValue})}),this.renderer.listen(this.newElement,"keyup.esc",function(){e.confirmFieldChange(!0)})},e.prototype.addTreeAction=function(e){this.treeActions.push(e)},e.prototype.prepareAddField=function(){if(this.nodeElements.path[3].children.length>1)if(this.nodeElements.path[3].children[0].classList.contains("k-i-expand"))this.nodeElements.path[3].children[0].click();else{if(this.isNewNode=!0,2===(t=this.nodeElements.path[4].children[1].children[0].cloneNode(!0)).children[0].children.length&&t.children[0].removeChild(t.children[0].children[0]),t.children[0].children[1===t.children[0].children.length?0:1].children[1].innerText="",t.children.length>1)for(var e=1;e<t.children.length;e++)this.renderer.removeChild(t,t.children[e]);this.addListeners(t),this.renderer.setAttribute(t,"id",""+this.nodeIdCounter),this.nodeIdCounter=--this.nodeIdCounter,this.renderer.appendChild(this.nodeElements.path[4].children[1],t),t.children[0].children[1===t.children[0].children.length?0:1].children[2].children[1].click()}else{this.isNewNode=!0;var t=this.nodeElements.path[5].cloneNode(!1),i=this.nodeElements.path[4].cloneNode(!0);this.renderer.removeClass(this.nodeElements.path[4].children[0].children[0].children[0],"fa-folder"),this.renderer.addClass(this.nodeElements.path[4].children[0].children[0].children[0],"fa-folder-open");var n=this.createTreeSpanWithIcon();this.renderer.insertBefore(this.nodeElements.path[3],n,this.nodeElements.path[3].children[0]),this.renderer.setAttribute(i,"id",""+this.nodeIdCounter),this.nodeIdCounter=--this.nodeIdCounter,i.children[0].children[0].children[1].innerText="",this.addListeners(i),this.renderer.removeClass(i.children[0].children[0],"k-state-selected"),this.renderer.appendChild(t,i),this.renderer.appendChild(this.nodeElements.path[4],t),i.children[0].children[0].children[2].children[1].click()}},e.prototype.createTreeSpanWithIcon=function(){var e=this.renderer.createElement("span");return this.renderer.addClass(e,"k-icon"),this.renderer.addClass(e,"k-i-collapse"),this.renderer.addClass(e,"ng-star-inserted"),e},e.prototype.addListeners=function(e){var t=this;this.renderer.listen(e.children[0].children[1===e.children[0].children.length?0:1].children[2].children[0],"click",function(e){t.onNodeActionClick({action:"add",event:e})}),this.renderer.listen(e.children[0].children[1===e.children[0].children.length?0:1].children[2].children[1],"click",function(e){t.onNodeActionClick({action:"edit",event:e})}),this.renderer.listen(e.children[0].children[1===e.children[0].children.length?0:1].children[2].children[2],"click",function(e){t.onNodeActionClick({action:"delete",event:e})})},e.prototype.confirmFieldChange=function(e){e||(this.newNodeValue=this.newElement.value,this.changeableNode.children[1].innerText=(this.prefix?this.prefix+" ":"")+this.newNodeValue),this.renderer.removeChild(this.nodeElements.path[3],this.newElement),this.renderer.appendChild(this.nodeElements.path[3],this.changeableNode),this.newElement=void 0,this.prefix=""},e.prototype.openConfirmation=function(){this.isDraggableNode||(this.confirmationText='Are you sure you want to delete "'+this.nodeElements.path[2].children[1].innerText+'" node?'),this.isConfirmationOpen=!0},e.prototype.closeConfirmation=function(){this.isConfirmationOpen=!1},e.prototype.confirmAction=function(){this.isDraggableNode?this.confirmDropping():this.confirmRemoving(),this.isConfirmationOpen=!1},e.prototype.confirmRemoving=function(){this.addTreeAction({Action:o.Delete,TopicId:this.newNodeId}),1===this.nodeElements.path[5].children.length?(this.renderer.removeClass(this.nodeElements.path[6].children[0].children[1].children[0],"fa-folder-open"),this.renderer.addClass(this.nodeElements.path[6].children[0].children[1].children[0],"fa-folder"),this.renderer.removeChild(this.nodeElements.path[6],this.nodeElements.path[6].children[1]),this.renderer.removeChild(this.nodeElements.path[6].children[0],this.nodeElements.path[6].children[0].children[0])):this.renderer.removeChild(this.nodeElements.path[5],this.nodeElements.path[4])},e.prototype.confirmDropping=function(){},e.prototype.onFolderChanged=function(e){console.log("onFolderChanged",e),this.folderActions=e},e.prototype.acceptTreeChanges=function(){var e=this,t={siteId:this.topicOptions.siteId,rootId:this.topicOptions.topicId,actions:this.folderActions};this.isLoading=!0,this.folderManagementService.modifyIndexAndUnlock(t).subscribe(function(){e.isLoading=!1,e.close$.emit()})},e}()}}]);